###############################################################################
#                                                                             #
# IAR C/C++ Compiler V7.51A/W32 for 8051                02/Jan/2013  10:30:15 #
# Copyright 2004-2009 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0\Com #
#                          ponents\stack\sapi\sapi.c                          #
#    Command line       =  -f "C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0 #
#                          \Projects\zstack\Samples\SensorDemo\CC2530DB\..\.. #
#                          \..\Tools\CC2530DB\f8wEndev.cfg" (-DCPU32MHZ       #
#                          -DROOT=__near_func -DBLINK_LEDS) -f "C:\Texas      #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\Tools\CC2 #
#                          530DB\f8wConfig.cfg" (-DSECURE=0                   #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0x1234                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          "C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0\Co #
#                          mponents\stack\sapi\sapi.c" -D NWK_AUTO_POLL -D    #
#                          REFLECTOR -D POWER_SAVING -D NV_INIT -D            #
#                          NV_RESTORE -D DEVICE_LOGICAL_TYPE=ZG_DEVICETYPE_EN #
#                          DDEVICE -D LCD_SUPPORTED -lC "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\SensorEB\List\"    #
#                          -lA "C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4. #
#                          0\Projects\zstack\Samples\SensorDemo\CC2530DB\Sens #
#                          orEB\List\" --diag_suppress Pe001,Pa010 -o         #
#                          "C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0\Pr #
#                          ojects\zstack\Samples\SensorDemo\CC2530DB\SensorEB #
#                          \Obj\" -e --require_prototypes --debug             #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\" -I "C:\Texas     #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\SOURCE\" -I     #
#                          "C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0\Pr #
#                          ojects\zstack\Samples\SensorDemo\CC2530DB\..\..\.. #
#                          \ZMAIN\TI2530DB\" -I "C:\Texas                     #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\MT\" -I "C:\Texas                          #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\HAL\INCLUDE\" -I "C:\Texas                 #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\HAL\TARGET\CC2530EB\" -I "C:\Texas         #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\OSAL\MCU\CCSOC\" -I "C:\Texas              #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\OSAL\INCLUDE\" -I "C:\Texas                #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\STACK\AF\" -I "C:\Texas                    #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\STACK\NWK\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\STACK\SEC\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\STACK\SAPI\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\STACK\SYS\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\STACK\ZDO\" -I "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\ZMAC\F8W\" -I "C:\Texas                    #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\ZMAC\" -I "C:\Texas                        #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\SERVICES\SADDR\" -I "C:\Texas              #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\SERVICES\SDATA\" -I "C:\Texas              #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\MAC\INCLUDE\" -I "C:\Texas                 #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\MAC\HIGH_LEVEL\" -I "C:\Texas              #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\MAC\LOW_LEVEL\srf04\" -I "C:\Texas         #
#                          Instruments\ZStack-CC2530-2.3.0-1.4.0\Projects\zst #
#                          ack\Samples\SensorDemo\CC2530DB\..\..\..\..\..\COM #
#                          PONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\" -I       #
#                          "C:\Program Files\IAR Systems\Embedded Workbench   #
#                          5.3\8051\INC\" -I "C:\Program Files\IAR            #
#                          Systems\Embedded Workbench 5.3\8051\INC\CLIB\"     #
#                          -Ohz                                               #
#    List file          =  C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0\Pro #
#                          jects\zstack\Samples\SensorDemo\CC2530DB\SensorEB\ #
#                          List\sapi.lst                                      #
#    Object file        =  C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0\Pro #
#                          jects\zstack\Samples\SensorDemo\CC2530DB\SensorEB\ #
#                          Obj\sapi.r51                                       #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-CC2530-2.3.0-1.4.0\Components\stack\sapi\sapi.c
      1          /**************************************************************************************************
      2            Filename:       sapi.c
      3            Revised:        $Date: 2010-01-06 16:39:32 -0800 (Wed, 06 Jan 2010) $
      4            Revision:       $Revision: 21446 $
      5          
      6            Description:    Z-Stack Simple Application Interface.
      7          
      8          
      9            Copyright 2007-2010 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /******************************************************************************
     41           * INCLUDES
     42           */
     43          
     44          #include "ZComDef.h"
     45          #include "hal_drivers.h"
     46          #include "OSAL.h"
     47          #include "OSAL_Tasks.h"
     48          //#include "OSAL_Custom.h"
     49          
     50          #if defined ( MT_TASK )
     51            #include "MT.h"
     52            #include "MT_TASK.h"
     53          #endif
     54          
     55          #include "nwk.h"
     56          #include "APS.h"
     57          #include "ZDApp.h"
     58          
     59          #include "osal_nv.h"
     60          #include "NLMEDE.h"
     61          #include "AF.h"
     62          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc9
   \   unsigned char volatile __sfr WDCTL
   \                     WDCTL:
   \   000000                DS 1
     63          #include "nwk_util.h"
     64          #include "ZDProfile.h"
     65          #include "ZDObject.h"
     66          #include "hal_led.h"
     67          #include "hal_key.h"
     68          #include "sapi.h"
     69          #include "MT_SAPI.h"
     70          #if (DEVICE_LOGICAL_TYPE == ZG_DEVICETYPE_ENDDEVICE)
     71          extern uint8 reportState ;
     72          #endif
     73          extern uint8 zgStartDelay;
     74          extern uint8 zgSapiEndpoint;
     75          /*********************************************************************
     76           * CONSTANTS
     77           */
     78          
     79          #if !defined OSAL_SAPI
     80          #define OSAL_SAPI  TRUE
     81          #endif
     82          
     83          #if !defined SAPI_CB_FUNC
     84          #define SAPI_CB_FUNC  TRUE
     85          #endif
     86          
     87          // Message ID's for application user messages must be in 0xE0-0xEF range
     88          #define ZB_USER_MSG                       0xE0
     89          #define SAPICB_DATA_CNF   0xE0
     90          #define SAPICB_BIND_CNF   0xE1
     91          #define SAPICB_START_CNF  0xE2
     92          
     93          /*********************************************************************
     94           * TYPEDEFS
     95           */
     96          
     97          /*********************************************************************
     98           * GLOBAL VARIABLES
     99           */
    100          
    101          #if OSAL_SAPI
    102          // The order in this table must be identical to the task initialization calls below in osalInitTask.

   \                                 In  segment XDATA_ROM_C, align 1
    103          const pTaskEventHandlerFn tasksArr[] = {
   \                     tasksArr:
   \   000000   ........     DW ??macEventLoop?relay, ??nwk_event_loop?relay
   \   000004   ........     DW ??Hal_ProcessEvent?relay, ??APS_event_loop?relay
   \   000008   ........     DW ??ZDApp_event_loop?relay, ??SAPI_ProcessEvent?relay
    104            macEventLoop,
    105            nwk_event_loop,
    106            Hal_ProcessEvent,
    107          #if defined( MT_TASK )
    108            MT_ProcessEvent,
    109          #endif
    110            APS_event_loop,
    111            ZDApp_event_loop,
    112          
    113            SAPI_ProcessEvent
    114          };
    115          

   \                                 In  segment XDATA_ROM_C, align 1
    116          const uint8 tasksCnt = sizeof( tasksArr ) / sizeof( tasksArr[0] );
   \                     tasksCnt:
   \   000000   06           DB 6

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    117          uint16 *tasksEvents;
   \                     tasksEvents:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    118          #endif
    119          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    120          endPointDesc_t sapi_epDesc;
   \                     sapi_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    121          uint8 sapi_TaskID;
   \                     sapi_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    122          static uint16 sapi_bindInProgress;
   \                     sapi_bindInProgress:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    123          
    124          /*********************************************************************
    125           * LOCAL FUNCTIONS
    126           */
    127          
    128          void SAPI_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg );
    129          static void SAPI_SendCback( uint8 event, uint8 status, uint16 data );
    130          
    131          static void SAPI_StartConfirm( uint8 status );
    132          static void SAPI_SendDataConfirm( uint8 handle, uint8 status );
    133          static void SAPI_BindConfirm( uint16 commandId, uint8 status );
    134          static void SAPI_FindDeviceConfirm( uint8 searchType,
    135                                                  uint8 *searchKey, uint8 *result );
    136          static void SAPI_ReceiveDataIndication( uint16 source,
    137                                        uint16 command, uint16 len, uint8 *pData  );
    138          static void SAPI_AllowBindConfirm( uint16 source );
    139          
    140          /******************************************************************************
    141           * @fn          zb_SystemReset
    142           *
    143           * @brief       The zb_SystemReset function reboots the ZigBee device.  The
    144           *              zb_SystemReset function can be called after a call to
    145           *              zb_WriteConfiguration to restart Z-Stack with the updated
    146           *              configuration.
    147           *
    148           * @param       none
    149           *
    150           * @return      none
    151           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    152          void zb_SystemReset ( void )
   \                     zb_SystemReset:
    153          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    154            SystemReset();
   \   000000   C2AF         CLR     0xa8.7
   \   000002   75C9AB       MOV     0xc9,#-0x55
   \   000005   75C95B       MOV     0xc9,#0x5b
   \                     ??zb_SystemReset_0:
   \   000008   80FE         SJMP    ??zb_SystemReset_0
   \   00000A                REQUIRE _A_IEN0
   \   00000A                REQUIRE WDCTL
    155          }
    156          
    157          /******************************************************************************
    158           * @fn          zb_StartRequest
    159           *
    160           * @brief       The zb_StartRequest function starts the ZigBee stack.  When the
    161           *              ZigBee stack starts, the device reads configuration parameters
    162           *              from Nonvolatile memory and the device joins its network.  The
    163           *              ZigBee stack calls the zb_StartConrifm callback function when
    164           *              the startup process completes.
    165           *
    166           * @param       none
    167           *
    168           * @return      none
    169           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    170          void zb_StartRequest()
   \                     zb_StartRequest:
    171          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    172            uint8 logicalType;
    173          
    174            zb_ReadConfiguration( ZCD_NV_LOGICAL_TYPE, sizeof(uint8), &logicalType );
   \   00000A                ; Setup parameters for call to function zb_ReadConfiguration
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   AC82         MOV     R4,DPL
   \   000012   AD83         MOV     R5,DPH
   \   000014   7A01         MOV     R2,#0x1
   \   000016   7987         MOV     R1,#-0x79
   \   000018   12....       LCALL   ?Subroutine0 & 0xFFFF
    175          
    176            // Check for bad combinations of compile flag definitions and device type setting.
    177            if ((logicalType > ZG_DEVICETYPE_ENDDEVICE)      ||
    178          #if !ZG_BUILD_ENDDEVICE_TYPE   // Only RTR or Coord possible.
    179                (logicalType == ZG_DEVICETYPE_ENDDEVICE)     ||
    180          #endif
    181          #if !ZG_BUILD_RTR_TYPE         // Only End Device possible.
    182                (logicalType == ZG_DEVICETYPE_ROUTER)        ||
    183                (logicalType == ZG_DEVICETYPE_COORDINATOR)   ||
    184          #elif ZG_BUILD_RTRONLY_TYPE    // Only RTR possible.
    185                (logicalType == ZG_DEVICETYPE_COORDINATOR)   ||
    186          #elif !ZG_BUILD_JOINING_TYPE   // Only Coord possible.
    187                (logicalType == ZG_DEVICETYPE_ROUTER)        ||
    188          #endif
    189                (0))
   \                     ??CrossCallReturnLabel_0:
   \   00001B   C3           CLR     C
   \   00001C   9403         SUBB    A,#0x3
   \   00001E   5008         JNC     ??zb_StartRequest_0
   \   000020   E0           MOVX    A,@DPTR
   \   000021   6401         XRL     A,#0x1
   \   000023   6003         JZ      ??zb_StartRequest_0
   \   000025   E0           MOVX    A,@DPTR
   \   000026   700F         JNZ     ??zb_StartRequest_1
    190            {
    191              logicalType = ZB_INVALID_PARAMETER;
   \                     ??zb_StartRequest_0:
   \   000028   7402         MOV     A,#0x2
   \   00002A   F0           MOVX    @DPTR,A
    192              SAPI_SendCback(SAPICB_START_CNF, logicalType, 0);
   \   00002B                ; Setup parameters for call to function SAPI_SendCback
   \   00002B   7C00         MOV     R4,#0x0
   \   00002D   7D00         MOV     R5,#0x0
   \   00002F   FA           MOV     R2,A
   \   000030   79E2         MOV     R1,#-0x1e
   \   000032   12....       LCALL   ??SAPI_SendCback?relay
   \   000035   800C         SJMP    ??zb_StartRequest_2
    193            }
    194            else
    195            {
    196              logicalType = ZB_SUCCESS;
   \                     ??zb_StartRequest_1:
   \   000037   E4           CLR     A
   \   000038   F0           MOVX    @DPTR,A
    197              ZDOInitDevice(zgStartDelay);
   \   000039                ; Setup parameters for call to function ZDOInitDevice
   \   000039   90....       MOV     DPTR,#zgStartDelay
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   FA           MOV     R2,A
   \   00003E   7B00         MOV     R3,#0x0
   \   000040   12....       LCALL   ??ZDOInitDevice?relay
    198            }
    199          
    200            
    201            return;
   \                     ??zb_StartRequest_2:
   \   000043   7401         MOV     A,#0x1
   \   000045                REQUIRE ?Subroutine13
   \   000045                ; // Fall through to label ?Subroutine13
    202          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine18_0
   \   000003                ; // Fall through to label ??Subroutine18_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine18_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ??zb_ReadConfiguration?relay
   \   000003   85..82       MOV     DPL,?XSP + 0
   \   000006   85..83       MOV     DPH,?XSP + 1
   \   000009   E0           MOVX    A,@DPTR
   \   00000A   22           RET
    203          
    204          /******************************************************************************
    205           * @fn          zb_BindDevice
    206           *
    207           * @brief       The zb_BindDevice function establishes or removes a ‘binding? *              between two devices.  Once bound, an application can send
    208           *              messages to a device by referencing the commandId for the
    209           *              binding.
    210           *
    211           * @param       create - TRUE to create a binding, FALSE to remove a binding
    212           *              commandId - The identifier of the binding
    213           *              pDestination - The 64-bit IEEE address of the device to bind to
    214           *
    215           * @return      The status of the bind operation is returned in the
    216           *              zb_BindConfirm callback.
    217           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    218          void zb_BindDevice ( uint8 create, uint16 commandId, uint8 *pDestination )
   \                     zb_BindDevice:
    219          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 11
   \   000005   74F5         MOV     A,#-0xb
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
   \   000015   EC           MOV     A,R4
   \   000016   FE           MOV     R6,A
   \   000017   ED           MOV     A,R5
   \   000018   FF           MOV     R7,A
    220            zAddrType_t destination;
    221            uint8 ret = ZB_ALREADY_IN_PROGRESS;
   \   000019   75..20       MOV     ?V0 + 0,#0x20
    222          
    223            if ( create )
   \   00001C   E9           MOV     A,R1
   \   00001D   7003         JNZ     $+5
   \   00001F   02....       LJMP    ??zb_BindDevice_0 & 0xFFFF
    224            {
    225              if (sapi_bindInProgress == 0xffff)
   \   000022   90....       MOV     DPTR,#sapi_bindInProgress
   \   000025   E0           MOVX    A,@DPTR
   \   000026   64FF         XRL     A,#0xff
   \   000028   7004         JNZ     ??zb_BindDevice_1
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   64FF         XRL     A,#0xff
   \                     ??zb_BindDevice_1:
   \   00002E   7058         JNZ     ??CrossCallReturnLabel_23
    226              {
    227                if ( pDestination )
   \   000030   EE           MOV     A,R6
   \   000031   7001         JNZ     ??zb_BindDevice_2
   \   000033   EF           MOV     A,R7
   \                     ??zb_BindDevice_2:
   \   000034   6067         JZ      ??zb_BindDevice_3
    228                {
    229                  destination.addrMode = Addr64Bit;
   \   000036   740A         MOV     A,#0xa
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   7403         MOV     A,#0x3
   \   00003D   F0           MOVX    @DPTR,A
    230                  osal_cpyExtAddr( destination.addr.extAddr, pDestination );
   \   00003E                ; Setup parameters for call to function sAddrExtCpy
   \   00003E   7402         MOV     A,#0x2
   \   000040   12....       LCALL   ?XSTACK_DISP0_8
   \   000043   AA82         MOV     R2,DPL
   \   000045   AB83         MOV     R3,DPH
   \   000047   12....       LCALL   ??sAddrExtCpy?relay
    231          
    232                  ret = APSME_BindRequest( sapi_epDesc.endPoint, commandId,
    233                                                      &destination, sapi_epDesc.endPoint );
   \   00004A                ; Setup parameters for call to function APSME_BindRequest
   \   00004A   90....       MOV     DPTR,#sapi_epDesc
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   F5..         MOV     ?V0 + 0,A
   \   000050   78..         MOV     R0,#?V0 + 0
   \   000052   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000055   7403         MOV     A,#0x3
   \   000057   12....       LCALL   ?XSTACK_DISP0_8
   \   00005A   AC82         MOV     R4,DPL
   \   00005C   AD83         MOV     R5,DPH
   \   00005E   7401         MOV     A,#0x1
   \   000060   12....       LCALL   ?XSTACK_DISP0_8
   \   000063   12....       LCALL   ??Subroutine20_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_28:
   \   000066   90....       MOV     DPTR,#sapi_epDesc
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F9           MOV     R1,A
   \   00006B   12....       LCALL   ??APSME_BindRequest?relay
   \   00006E   7401         MOV     A,#0x1
   \   000070   12....       LCALL   ?DEALLOC_XSTACK8
   \   000073   E9           MOV     A,R1
   \   000074   F5..         MOV     ?V0 + 0,A
    234          
    235                  if ( ret == ZSuccess )
   \   000076   7010         JNZ     ??CrossCallReturnLabel_23
    236                  {
    237                    // Find nwk addr
    238                    ZDP_NwkAddrReq(pDestination, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
   \   000078                ; Setup parameters for call to function ZDP_NwkAddrReq
   \   000078   7D00         MOV     R5,#0x0
   \   00007A   7C00         MOV     R4,#0x0
   \   00007C   7900         MOV     R1,#0x0
   \   00007E   EE           MOV     A,R6
   \   00007F   FA           MOV     R2,A
   \   000080   EF           MOV     A,R7
   \   000081   FB           MOV     R3,A
   \   000082   12....       LCALL   ??ZDP_NwkAddrReq?relay
    239                    osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, 250 );
   \   000085                ; Setup parameters for call to function osal_start_timerEx
   \   000085   12....       LCALL   ?Subroutine5 & 0xFFFF
    240                  }
    241                }
    242                else
    243                {
    244                  ret = ZB_INVALID_PARAMETER;
    245                  destination.addrMode = Addr16Bit;
    246                  destination.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
    247                  if ( ZDO_AnyClusterMatches( 1, &commandId, sapi_epDesc.simpleDesc->AppNumOutClusters,
    248                                                          sapi_epDesc.simpleDesc->pAppOutClusterList ) )
    249                  {
    250                    // Try to match with a device in the allow bind mode
    251                    ret = ZDP_MatchDescReq( &destination, NWK_BROADCAST_SHORTADDR,
    252                        sapi_epDesc.simpleDesc->AppProfId, 1, &commandId, 0, (cId_t *)NULL, 0 );
    253                  }
    254                  else if ( ZDO_AnyClusterMatches( 1, &commandId, sapi_epDesc.simpleDesc->AppNumInClusters,
    255                                                          sapi_epDesc.simpleDesc->pAppInClusterList ) )
    256                  {
    257                    ret = ZDP_MatchDescReq( &destination, NWK_BROADCAST_SHORTADDR,
    258                        sapi_epDesc.simpleDesc->AppProfId, 0, (cId_t *)NULL, 1, &commandId, 0 );
    259                  }
    260          
    261                  if ( ret == ZB_SUCCESS )
    262                  {
    263                    // Set a timer to make sure bind completes
    264          #if ( ZG_BUILD_RTR_TYPE )
    265                    osal_start_timerEx(sapi_TaskID, ZB_BIND_TIMER, AIB_MaxBindingTime);
    266          #else
    267                    // AIB_MaxBindingTime is not defined for an End Device
    268                    osal_start_timerEx(sapi_TaskID, ZB_BIND_TIMER, zgApsDefaultMaxBindingTime);
    269          #endif
    270                    sapi_bindInProgress = commandId;
    271                    return; // dont send cback event
    272                  }
    273                }
    274              }
    275          
    276              SAPI_SendCback( SAPICB_BIND_CNF, ret, commandId );
   \                     ??CrossCallReturnLabel_23:
   \   000088                ; Setup parameters for call to function SAPI_SendCback
   \   000088   85..82       MOV     DPL,?XSP + 0
   \   00008B   85..83       MOV     DPH,?XSP + 1
   \   00008E   E0           MOVX    A,@DPTR
   \   00008F   FC           MOV     R4,A
   \   000090   A3           INC     DPTR
   \   000091   E0           MOVX    A,@DPTR
   \   000092   FD           MOV     R5,A
   \   000093   AA..         MOV     R2,?V0 + 0
   \   000095   79E1         MOV     R1,#-0x1f
   \   000097   12....       LCALL   ??SAPI_SendCback?relay
   \   00009A   02....       LJMP    ??CrossCallReturnLabel_24 & 0xFFFF
   \                     ??zb_BindDevice_3:
   \   00009D   75..02       MOV     ?V0 + 0,#0x2
   \   0000A0   740A         MOV     A,#0xa
   \   0000A2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A5   7402         MOV     A,#0x2
   \   0000A7   F0           MOVX    @DPTR,A
   \   0000A8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AB   74FF         MOV     A,#-0x1
   \   0000AD   F0           MOVX    @DPTR,A
   \   0000AE   A3           INC     DPTR
   \   0000AF   F0           MOVX    @DPTR,A
   \   0000B0   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   0000B3   A3           INC     DPTR
   \   0000B4   A3           INC     DPTR
   \   0000B5   A3           INC     DPTR
   \   0000B6   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000B9   8882         MOV     DPL,R0
   \   0000BB   8983         MOV     DPH,R1
   \   0000BD   A3           INC     DPTR
   \   0000BE   A3           INC     DPTR
   \   0000BF   A3           INC     DPTR
   \   0000C0   A3           INC     DPTR
   \   0000C1   A3           INC     DPTR
   \   0000C2   A3           INC     DPTR
   \   0000C3   A3           INC     DPTR
   \   0000C4   A3           INC     DPTR
   \   0000C5   A3           INC     DPTR
   \   0000C6   E0           MOVX    A,@DPTR
   \   0000C7   FC           MOV     R4,A
   \   0000C8   7402         MOV     A,#0x2
   \   0000CA   12....       LCALL   ?XSTACK_DISP0_8
   \   0000CD   AA82         MOV     R2,DPL
   \   0000CF   AB83         MOV     R3,DPH
   \   0000D1   7901         MOV     R1,#0x1
   \   0000D3   12....       LCALL   ??ZDO_AnyClusterMatches?relay
   \   0000D6   7402         MOV     A,#0x2
   \   0000D8   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000DB   E9           MOV     A,R1
   \   0000DC   602F         JZ      ??zb_BindDevice_4
   \   0000DE                ; Setup parameters for call to function ZDP_MatchDescReq
   \   0000DE   75..00       MOV     ?V0 + 0,#0x0
   \   0000E1   78..         MOV     R0,#?V0 + 0
   \   0000E3   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000E6   75..00       MOV     ?V0 + 1,#0x0
   \   0000E9   78..         MOV     R0,#?V0 + 0
   \   0000EB   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000EE   78..         MOV     R0,#?V0 + 0
   \   0000F0   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000F3   7404         MOV     A,#0x4
   \   0000F5   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F8   8582..       MOV     ?V0 + 0,DPL
   \   0000FB   8583..       MOV     ?V0 + 1,DPH
   \   0000FE   78..         MOV     R0,#?V0 + 0
   \   000100   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000103   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   000106   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000109   7901         MOV     R1,#0x1
   \   00010B   805E         SJMP    ??zb_BindDevice_5
   \                     ??zb_BindDevice_4:
   \   00010D   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   000110   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000113   8882         MOV     DPL,R0
   \   000115   8983         MOV     DPH,R1
   \   000117   A3           INC     DPTR
   \   000118   A3           INC     DPTR
   \   000119   A3           INC     DPTR
   \   00011A   A3           INC     DPTR
   \   00011B   A3           INC     DPTR
   \   00011C   A3           INC     DPTR
   \   00011D   E0           MOVX    A,@DPTR
   \   00011E   FC           MOV     R4,A
   \   00011F   7402         MOV     A,#0x2
   \   000121   12....       LCALL   ?XSTACK_DISP0_8
   \   000124   AA82         MOV     R2,DPL
   \   000126   AB83         MOV     R3,DPH
   \   000128   7901         MOV     R1,#0x1
   \   00012A   12....       LCALL   ??ZDO_AnyClusterMatches?relay
   \   00012D   7402         MOV     A,#0x2
   \   00012F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000132   E9           MOV     A,R1
   \   000133   7003         JNZ     $+5
   \   000135   02....       LJMP    ??CrossCallReturnLabel_23 & 0xFFFF
   \   000138                ; Setup parameters for call to function ZDP_MatchDescReq
   \   000138   75..00       MOV     ?V0 + 0,#0x0
   \   00013B   78..         MOV     R0,#?V0 + 0
   \   00013D   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000140   7401         MOV     A,#0x1
   \   000142   12....       LCALL   ?XSTACK_DISP0_8
   \   000145   8582..       MOV     ?V0 + 0,DPL
   \   000148   8583..       MOV     ?V0 + 1,DPH
   \   00014B   78..         MOV     R0,#?V0 + 0
   \   00014D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000150   75..01       MOV     ?V0 + 0,#0x1
   \   000153   78..         MOV     R0,#?V0 + 0
   \   000155   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000158   75..00       MOV     ?V0 + 0,#0x0
   \   00015B   75..00       MOV     ?V0 + 1,#0x0
   \   00015E   78..         MOV     R0,#?V0 + 0
   \   000160   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000163   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   000166   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000169   7900         MOV     R1,#0x0
   \                     ??zb_BindDevice_5:
   \   00016B   7CFF         MOV     R4,#-0x1
   \   00016D   7DFF         MOV     R5,#-0x1
   \   00016F   740A         MOV     A,#0xa
   \   000171   12....       LCALL   ?XSTACK_DISP0_8
   \   000174   AA82         MOV     R2,DPL
   \   000176   AB83         MOV     R3,DPH
   \   000178   12....       LCALL   ??ZDP_MatchDescReq?relay
   \   00017B   7408         MOV     A,#0x8
   \   00017D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000180   E9           MOV     A,R1
   \   000181   F5..         MOV     ?V0 + 0,A
   \   000183   E5..         MOV     A,?V0 + 0
   \   000185   6003         JZ      $+5
   \   000187   02....       LJMP    ??CrossCallReturnLabel_23 & 0xFFFF
   \   00018A                ; Setup parameters for call to function osal_start_timerEx
   \   00018A   90....       MOV     DPTR,#zgApsDefaultMaxBindingTime
   \   00018D   E0           MOVX    A,@DPTR
   \   00018E   FC           MOV     R4,A
   \   00018F   A3           INC     DPTR
   \   000190   E0           MOVX    A,@DPTR
   \   000191   FD           MOV     R5,A
   \   000192   7A00         MOV     R2,#0x0
   \   000194   7B20         MOV     R3,#0x20
   \   000196   90....       MOV     DPTR,#sapi_TaskID
   \   000199   12....       LCALL   ??Subroutine19_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_26:
   \   00019C   85..82       MOV     DPL,?XSP + 0
   \   00019F   85..83       MOV     DPH,?XSP + 1
   \   0001A2   E0           MOVX    A,@DPTR
   \   0001A3   F8           MOV     R0,A
   \   0001A4   A3           INC     DPTR
   \   0001A5   E0           MOVX    A,@DPTR
   \   0001A6   F9           MOV     R1,A
   \   0001A7   90....       MOV     DPTR,#sapi_bindInProgress
   \   0001AA   E8           MOV     A,R0
   \   0001AB   F0           MOVX    @DPTR,A
   \   0001AC   A3           INC     DPTR
   \   0001AD   E9           MOV     A,R1
   \   0001AE   F0           MOVX    @DPTR,A
   \   0001AF   801A         SJMP    ??CrossCallReturnLabel_24
    277            }
    278            else
    279            {
    280              // Remove local bindings for the commandId
    281              BindingEntry_t *pBind;
    282          
    283              // Loop through bindings an remove any that match the cluster
    284              while ( pBind = bindFind( sapi_epDesc.simpleDesc->EndPoint, commandId, 0 ) )
    285              {
    286                bindRemoveEntry(pBind);
   \                     ??zb_BindDevice_6:
   \   0001B1                ; Setup parameters for call to function bindRemoveEntry
   \   0001B1   12....       LCALL   ??bindRemoveEntry?relay
    287              }
   \                     ??zb_BindDevice_0:
   \   0001B4                ; Setup parameters for call to function bindFind
   \   0001B4   7C00         MOV     R4,#0x0
   \   0001B6   85..82       MOV     DPL,?XSP + 0
   \   0001B9   85..83       MOV     DPH,?XSP + 1
   \   0001BC   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   0001BF   12....       LCALL   ??bindFind?relay
   \   0001C2   EA           MOV     A,R2
   \   0001C3   7001         JNZ     ??zb_BindDevice_7
   \   0001C5   EB           MOV     A,R3
   \                     ??zb_BindDevice_7:
   \   0001C6   70E9         JNZ     ??zb_BindDevice_6
    288              osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, 250 );
   \   0001C8                ; Setup parameters for call to function osal_start_timerEx
   \   0001C8   12....       LCALL   ?Subroutine5 & 0xFFFF
    289            }
   \                     ??CrossCallReturnLabel_24:
   \   0001CB   740B         MOV     A,#0xb
   \   0001CD                REQUIRE ?Subroutine14
   \   0001CD                ; // Fall through to label ?Subroutine14
    290            return;
    291          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F02         MOV     R7,#0x2
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   000003   A3           INC     DPTR
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   90....       MOV     DPTR,#(sapi_epDesc + 3)
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F8           MOV     R0,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   F9           MOV     R1,A
   \   000008                ; Setup parameters for call to function ZDO_AnyClusterMatches
   \   000008                ; Setup parameters for call to function ZDO_AnyClusterMatches
   \   000008   8882         MOV     DPL,R0
   \   00000A   8983         MOV     DPH,R1
   \   00000C   A3           INC     DPTR
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   7CFA         MOV     R4,#-0x6
   \   000002   7D00         MOV     R5,#0x0
   \   000004   7A00         MOV     R2,#0x0
   \   000006   7B02         MOV     R3,#0x2
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B                REQUIRE ??Subroutine19_0
   \   00000B                ; // Fall through to label ??Subroutine19_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine19_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   12....       LCALL   ??osal_start_timerEx?relay
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   90....       MOV     DPTR,#(sapi_epDesc + 3)
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F8           MOV     R0,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   F583         MOV     DPH,A
   \   000009   8882         MOV     DPL,R0
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine20_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FB           MOV     R3,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FB           MOV     R3,A
   \   000005   12....       LCALL   ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   22           RET
    292          /******************************************************************************
    293           * @fn          zb_PermitJoiningRequest
    294           *
    295           * @brief       The zb_PermitJoiningRequest function is used to control the
    296           *              joining permissions and thus allow or disallow new devices from
    297           *              joining the network.
    298           *
    299           * @param       destination - The destination parameter indicates the address
    300           *                            of the device for which the joining permissions
    301           *                            should be set. This is usually the local device
    302           *                            address or the special broadcast address that denotes
    303           *                            all routers and coordinator ( 0xFFFC ). This way
    304           *                            the joining permissions of a single device or the
    305           *                            whole network can be controlled.
    306           *              timeout -  Indicates the amount of time in seconds for which
    307           *                         the joining permissions should be turned on.
    308           *                         If timeout is set to 0x00, the device will turn off the
    309           *                         joining permissions indefinitely. If it is set to 0xFF,
    310           *                         the joining permissions will be turned on indefinitely.
    311           *
    312           *
    313           * @return      ZB_SUCCESS or a failure code
    314           *
    315           */
    316          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    317          uint8 zb_PermitJoiningRequest ( uint16 destination, uint8 timeout )
   \                     zb_PermitJoiningRequest:
    318          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    319          #if defined( ZDO_MGMT_PERMIT_JOIN_REQUEST )
    320            zAddrType_t dstAddr;
    321          
    322            dstAddr.addrMode = Addr16Bit;
    323            dstAddr.addr.shortAddr = destination;
    324          
    325            return( (uint8) ZDP_MgmtPermitJoinReq( &dstAddr, timeout, 0, 0 ) );
    326          #else
    327            (void)destination;
    328            (void)timeout;
    329            return ZUnsupportedMode;
   \   000000   7912         MOV     R1,#0x12
   \   000002   02....       LJMP    ?BRET
    330          #endif
    331          }
    332          /******************************************************************************
    333           * @fn          zb_AllowBind
    334           *
    335           * @brief       The zb_AllowBind function puts the device into the
    336           *              Allow Binding Mode for a given period of time.  A peer device
    337           *              can establish a binding to a device in the Allow Binding Mode
    338           *              by calling zb_BindDevice with a destination address of NULL
    339           *
    340           * @param       timeout - The number of seconds to remain in the allow binding
    341           *                        mode.  Valid values range from 1 through 65.
    342           *                        If 0, the Allow Bind mode will be set false without TO
    343           *                        If greater than 64, the Allow Bind mode will be true
    344           *
    345           * @return      ZB_SUCCESS if the device entered the allow bind mode, else
    346           *              an error code.
    347           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    348          void zb_AllowBind ( uint8 timeout )
   \                     zb_AllowBind:
    349          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    350          
    351            osal_stop_timerEx(sapi_TaskID, ZB_ALLOW_BIND_TIMER);
   \   000007                ; Setup parameters for call to function osal_stop_timerEx
   \   000007   7A00         MOV     R2,#0x0
   \   000009   7B40         MOV     R3,#0x40
   \   00000B   90....       MOV     DPTR,#sapi_TaskID
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F9           MOV     R1,A
   \   000010   12....       LCALL   ??osal_stop_timerEx?relay
    352          
    353            if ( timeout == 0 )
   \   000013   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000016   F9           MOV     R1,A
   \   000017   EE           MOV     A,R6
   \   000018   7007         JNZ     ??zb_AllowBind_0
    354            {
    355              afSetMatch(sapi_epDesc.simpleDesc->EndPoint, FALSE);
   \   00001A                ; Setup parameters for call to function afSetMatch
   \   00001A   7A00         MOV     R2,#0x0
   \   00001C   12....       LCALL   ??afSetMatch?relay
   \   00001F   802B         SJMP    ??CrossCallReturnLabel_27
    356            }
    357            else
    358            {
    359              afSetMatch(sapi_epDesc.simpleDesc->EndPoint, TRUE);
   \                     ??zb_AllowBind_0:
   \   000021                ; Setup parameters for call to function afSetMatch
   \   000021   7A01         MOV     R2,#0x1
   \   000023   12....       LCALL   ??afSetMatch?relay
    360              if ( timeout != 0xFF )
   \   000026   74FF         MOV     A,#-0x1
   \   000028   6E           XRL     A,R6
   \   000029   6021         JZ      ??CrossCallReturnLabel_27
    361              {
    362                if ( timeout > 64 )
   \   00002B   EE           MOV     A,R6
   \   00002C   C3           CLR     C
   \   00002D   9441         SUBB    A,#0x41
   \   00002F   4002         JC      ??zb_AllowBind_1
    363                {
    364                  timeout = 64;
   \   000031   7E40         MOV     R6,#0x40
    365                }
    366                osal_start_timerEx(sapi_TaskID, ZB_ALLOW_BIND_TIMER, timeout*1000);
   \                     ??zb_AllowBind_1:
   \   000033                ; Setup parameters for call to function osal_start_timerEx
   \   000033   EE           MOV     A,R6
   \   000034   FC           MOV     R4,A
   \   000035   75F0E8       MOV     B,#-0x18
   \   000038   A4           MUL     AB
   \   000039   CC           XCH     A,R4
   \   00003A   AAF0         MOV     R2,B
   \   00003C   75F003       MOV     B,#0x3
   \   00003F   A4           MUL     AB
   \   000040   2A           ADD     A,R2
   \   000041   FD           MOV     R5,A
   \   000042   7A00         MOV     R2,#0x0
   \   000044   7B40         MOV     R3,#0x40
   \   000046   90....       MOV     DPTR,#sapi_TaskID
   \   000049   12....       LCALL   ??Subroutine19_0 & 0xFFFF
    367              }
    368            }
    369            return;
   \                     ??CrossCallReturnLabel_27:
   \   00004C   02....       LJMP    ??Subroutine18_0 & 0xFFFF
    370          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   22           RET
    371          /******************************************************************************
    372           * @fn          zb_SendDataRequest
    373           *
    374           * @brief       The zb_SendDataRequest function initiates transmission of data
    375           *              to a peer device
    376           *
    377           * @param       destination - The destination of the data.  The destination can
    378           *                            be one of the following:
    379           *                            - 16-Bit short address of device [0-0xfffD]
    380           *                            - ZB_BROADCAST_ADDR sends the data to all devices
    381           *                              in the network.
    382           *                            - ZB_BINDING_ADDR sends the data to a previously
    383           *                              bound device.
    384           *
    385           *              commandId - The command ID to send with the message.  If the
    386           *                          ZB_BINDING_ADDR destination is used, this parameter
    387           *                          also indicates the binding to use.
    388           *
    389           *              len - The size of the pData buffer in bytes
    390           *              handle - A handle used to identify the send data request.
    391           *              txOptions - TRUE if requesting acknowledgement from the destination.
    392           *              radius - The max number of hops the packet can travel through
    393           *                       before it is dropped.
    394           *
    395           * @return      none
    396           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    397          void zb_SendDataRequest ( uint16 destination, uint16 commandId, uint8 len,
   \                     zb_SendDataRequest:
    398                                    uint8 *pData, uint8 handle, uint8 txOptions, uint8 radius )
    399          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 12
   \   000005   74F4         MOV     A,#-0xc
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8C..         MOV     ?V0 + 2,R4
   \   00000C   8D..         MOV     ?V0 + 3,R5
   \   00000E   E9           MOV     A,R1
   \   00000F   FE           MOV     R6,A
   \   000010   741A         MOV     A,#0x1a
   \   000012   12....       LCALL   ?XSTACK_DISP0_8
   \   000015   E0           MOVX    A,@DPTR
   \   000016   F5..         MOV     ?V0 + 4,A
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 5,A
   \   00001C   741D         MOV     A,#0x1d
   \   00001E   12....       LCALL   ?XSTACK_DISP0_8
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FF           MOV     R7,A
   \   000023   741E         MOV     A,#0x1e
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F5..         MOV     ?V0 + 0,A
    400            afStatus_t status;
    401            afAddrType_t dstAddr;
    402          
    403            txOptions |= AF_DISCV_ROUTE;
   \   00002B   EF           MOV     A,R7
   \   00002C   D2E5         SETB    0xE0 /* A   */.5
   \   00002E   FF           MOV     R7,A
    404          
    405            // Set the destination address
    406            if (destination == ZB_BINDING_ADDR)
   \   00002F   74FE         MOV     A,#-0x2
   \   000031   6A           XRL     A,R2
   \   000032   7003         JNZ     ??zb_SendDataRequest_0
   \   000034   74FF         MOV     A,#-0x1
   \   000036   6B           XRL     A,R3
   \                     ??zb_SendDataRequest_0:
   \   000037   7009         JNZ     ??zb_SendDataRequest_1
    407            {
    408              // Binding
    409              dstAddr.addrMode = afAddrNotPresent;
   \   000039   7408         MOV     A,#0x8
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   E4           CLR     A
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   801D         SJMP    ??zb_SendDataRequest_2
    410            }
    411            else
    412            {
    413              // Use short address
    414              dstAddr.addr.shortAddr = destination;
   \                     ??zb_SendDataRequest_1:
   \   000042   85..82       MOV     DPL,?XSP + 0
   \   000045   85..83       MOV     DPH,?XSP + 1
   \   000048   EA           MOV     A,R2
   \   000049   F0           MOVX    @DPTR,A
   \   00004A   A3           INC     DPTR
   \   00004B   EB           MOV     A,R3
   \   00004C   F0           MOVX    @DPTR,A
    415              dstAddr.addrMode = afAddr16Bit;
   \   00004D   7408         MOV     A,#0x8
   \   00004F   12....       LCALL   ?XSTACK_DISP0_8
   \   000052   7402         MOV     A,#0x2
   \   000054   F0           MOVX    @DPTR,A
    416          
    417              if ( ADDR_NOT_BCAST != NLME_IsAddressBroadcast( destination ) )
   \   000055                ; Setup parameters for call to function NLME_IsAddressBroadcast
   \   000055   12....       LCALL   ??NLME_IsAddressBroadcast?relay
   \   000058   E9           MOV     A,R1
   \   000059   6004         JZ      ??zb_SendDataRequest_2
    418              {
    419                txOptions &= ~AF_ACK_REQUEST;
   \   00005B   EF           MOV     A,R7
   \   00005C   C2E4         CLR     0xE0 /* A   */.4
   \   00005E   FF           MOV     R7,A
    420              }
    421            }
    422          
    423            dstAddr.panId = 0;                                    // Not an inter-pan message.
   \                     ??zb_SendDataRequest_2:
   \   00005F   740A         MOV     A,#0xa
   \   000061   12....       LCALL   ?XSTACK_DISP0_8
   \   000064   E4           CLR     A
   \   000065   F0           MOVX    @DPTR,A
   \   000066   A3           INC     DPTR
   \   000067   F0           MOVX    @DPTR,A
    424            dstAddr.endPoint = sapi_epDesc.simpleDesc->EndPoint;  // Set the endpoint.
   \   000068   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   00006B   C0E0         PUSH    A
   \   00006D   7409         MOV     A,#0x9
   \   00006F   12....       LCALL   ?XSTACK_DISP0_8
   \   000072   D0E0         POP     A
   \   000074   F0           MOVX    @DPTR,A
    425          
    426            // Send the message
    427            status = AF_DataRequest(&dstAddr, &sapi_epDesc, commandId, len,
    428                                    pData, &handle, txOptions, radius);
   \   000075                ; Setup parameters for call to function AF_DataRequest
   \   000075   78..         MOV     R0,#?V0 + 0
   \   000077   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00007A   741D         MOV     A,#0x1d
   \   00007C   12....       LCALL   ?XSTACK_DISP0_8
   \   00007F   8582..       MOV     ?V0 + 0,DPL
   \   000082   8583..       MOV     ?V0 + 1,DPH
   \   000085   78..         MOV     R0,#?V0 + 0
   \   000087   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008A   78..         MOV     R0,#?V0 + 4
   \   00008C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008F   8E..         MOV     ?V0 + 0,R6
   \   000091   75..00       MOV     ?V0 + 1,#0x0
   \   000094   78..         MOV     R0,#?V0 + 0
   \   000096   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000099   78..         MOV     R0,#?V0 + 2
   \   00009B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009E   EF           MOV     A,R7
   \   00009F   F9           MOV     R1,A
   \   0000A0   7C..         MOV     R4,#(sapi_epDesc & 0xff)
   \   0000A2   7D..         MOV     R5,#((sapi_epDesc >> 8) & 0xff)
   \   0000A4   7409         MOV     A,#0x9
   \   0000A6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A9   AA82         MOV     R2,DPL
   \   0000AB   AB83         MOV     R3,DPH
   \   0000AD   12....       LCALL   ??AF_DataRequest?relay
   \   0000B0   7409         MOV     A,#0x9
   \   0000B2   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B5   E9           MOV     A,R1
   \   0000B6   FA           MOV     R2,A
    429          
    430            if (status != afStatus_SUCCESS)
   \   0000B7   600E         JZ      ??zb_SendDataRequest_3
    431            {
    432              SAPI_SendCback( SAPICB_DATA_CNF, status, handle );
   \   0000B9                ; Setup parameters for call to function SAPI_SendCback
   \   0000B9   741C         MOV     A,#0x1c
   \   0000BB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000BE   E0           MOVX    A,@DPTR
   \   0000BF   FC           MOV     R4,A
   \   0000C0   7D00         MOV     R5,#0x0
   \   0000C2   79E0         MOV     R1,#-0x20
   \   0000C4   12....       LCALL   ??SAPI_SendCback?relay
    433            }
    434          }
   \                     ??zb_SendDataRequest_3:
   \   0000C7   740C         MOV     A,#0xc
   \   0000C9                REQUIRE ?Subroutine16
   \   0000C9                ; // Fall through to label ?Subroutine16

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F06         MOV     R7,#0x6
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA
    435          
    436          /******************************************************************************
    437           * @fn          zb_ReadConfiguration
    438           *
    439           * @brief       The zb_ReadConfiguration function is used to get a
    440           *              Configuration Protperty from Nonvolatile memory.
    441           *
    442           * @param       configId - The identifier for the configuration property
    443           *              len - The size of the pValue buffer in bytes
    444           *              pValue - A buffer to hold the configuration property
    445           *
    446           * @return      none
    447           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    448          uint8 zb_ReadConfiguration( uint8 configId, uint8 len, void *pValue )
   \                     zb_ReadConfiguration:
    449          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8C..         MOV     ?V0 + 0,R4
   \   000009   8D..         MOV     ?V0 + 1,R5
    450            uint8 size;
    451          
    452            size = (uint8)osal_nv_item_len( configId );
   \   00000B   8982         MOV     DPL,R1
   \   00000D   AE82         MOV     R6,DPL
   \   00000F                ; Setup parameters for call to function osal_nv_item_len
   \   00000F   EE           MOV     A,R6
   \   000010   FA           MOV     R2,A
   \   000011   7B00         MOV     R3,#0x0
   \   000013   12....       LCALL   ??osal_nv_item_len?relay
    453            if ( size > len )
   \   000016   E5..         MOV     A,?V0 + 2
   \   000018   C3           CLR     C
   \   000019   9A           SUBB    A,R2
   \   00001A   5004         JNC     ??zb_ReadConfiguration_0
    454            {
    455              return ZFailure;
   \   00001C   7901         MOV     R1,#0x1
   \   00001E   801F         SJMP    ??zb_ReadConfiguration_1
    456            }
    457            else
    458            {
    459              return( osal_nv_read(configId, 0, size, pValue) );
   \                     ??zb_ReadConfiguration_0:
   \   000020                ; Setup parameters for call to function osal_nv_read
   \   000020   78..         MOV     R0,#?V0 + 0
   \   000022   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000025   8A..         MOV     ?V0 + 0,R2
   \   000027   75..00       MOV     ?V0 + 1,#0x0
   \   00002A   78..         MOV     R0,#?V0 + 0
   \   00002C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002F   7C00         MOV     R4,#0x0
   \   000031   7D00         MOV     R5,#0x0
   \   000033   EE           MOV     A,R6
   \   000034   FA           MOV     R2,A
   \   000035   7B00         MOV     R3,#0x0
   \   000037   12....       LCALL   ??osal_nv_read?relay
   \   00003A   7404         MOV     A,#0x4
   \   00003C   12....       LCALL   ?DEALLOC_XSTACK8
    460            }
   \                     ??zb_ReadConfiguration_1:
   \   00003F                REQUIRE ?Subroutine17
   \   00003F                ; // Fall through to label ?Subroutine17
    461          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   7F03         MOV     R7,#0x3
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    462          /******************************************************************************
    463           * @fn          zb_WriteConfiguration
    464           *
    465           * @brief       The zb_WriteConfiguration function is used to write a
    466           *              Configuration Property to nonvolatile memory.
    467           *
    468           * @param       configId - The identifier for the configuration property
    469           *              len - The size of the pValue buffer in bytes
    470           *              pValue - A buffer containing the new value of the
    471           *                       configuration property
    472           *
    473           * @return      none
    474           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    475          uint8 zb_WriteConfiguration( uint8 configId, uint8 len, void *pValue )
   \                     zb_WriteConfiguration:
    476          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    477            return( osal_nv_write(configId, 0, len, pValue) );
   \   000005                ; Setup parameters for call to function osal_nv_write
   \   000005   8C..         MOV     ?V0 + 0,R4
   \   000007   8D..         MOV     ?V0 + 1,R5
   \   000009   78..         MOV     R0,#?V0 + 0
   \   00000B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00000E   8A..         MOV     ?V0 + 0,R2
   \   000010   75..00       MOV     ?V0 + 1,#0x0
   \   000013   78..         MOV     R0,#?V0 + 0
   \   000015   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000018   7C00         MOV     R4,#0x0
   \   00001A   7D00         MOV     R5,#0x0
   \   00001C   E9           MOV     A,R1
   \   00001D   FA           MOV     R2,A
   \   00001E   7B00         MOV     R3,#0x0
   \   000020   12....       LCALL   ??osal_nv_write?relay
   \   000023   7404         MOV     A,#0x4
   \   000025   02....       LJMP    ?Subroutine14 & 0xFFFF
    478          }
    479          /******************************************************************************
    480           * @fn          zb_GetDeviceInfo
    481           *
    482           * @brief       The zb_GetDeviceInfo function retrieves a Device Information
    483           *              Property.
    484           *
    485           * @param       param - The identifier for the device information
    486           *              pValue - A buffer to hold the device information
    487           *
    488           * @return      none
    489           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    490          void zb_GetDeviceInfo ( uint8 param, void *pValue )
   \                     zb_GetDeviceInfo:
    491          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
    492            switch(param)
   \   000005   E9           MOV     A,R1
   \   000006   12....       LCALL   ?UC_SWITCH_DENSE
   \                     `?<Jumptable for zb_GetDeviceInfo>_0`:
   \   000009   00           DB        0
   \   00000A   07           DB        7
   \   00000B   ....         DW        ??zb_GetDeviceInfo_0
   \   00000D   ....         DW        ??zb_GetDeviceInfo_1
   \   00000F   ....         DW        ??zb_GetDeviceInfo_2
   \   000011   ....         DW        ??zb_GetDeviceInfo_3
   \   000013   ....         DW        ??zb_GetDeviceInfo_4
   \   000015   ....         DW        ??zb_GetDeviceInfo_5
   \   000017   ....         DW        ??zb_GetDeviceInfo_6
   \   000019   ....         DW        ??zb_GetDeviceInfo_7
   \   00001B   ....         DW        ??zb_GetDeviceInfo_8
    493            {
    494              case ZB_INFO_DEV_STATE:
    495                osal_memcpy(pValue, &devState, sizeof(uint8));
   \                     ??zb_GetDeviceInfo_1:
   \   00001D                ; Setup parameters for call to function osal_memcpy
   \   00001D   75....       MOV     ?V0 + 0,#(devState & 0xff)
   \   000020   75....       MOV     ?V0 + 1,#((devState >> 8) & 0xff)
   \                     ??zb_GetDeviceInfo_9:
   \   000023   75..00       MOV     ?V0 + 2,#0x0
   \   000026   78..         MOV     R0,#?V0 + 0
   \   000028   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00002B   7C01         MOV     R4,#0x1
   \   00002D   804A         SJMP    ??zb_GetDeviceInfo_10
    496                break;
    497              case ZB_INFO_IEEE_ADDR:
    498                osal_memcpy(pValue, &aExtendedAddress, Z_EXTADDR_LEN);
   \                     ??zb_GetDeviceInfo_2:
   \   00002F                ; Setup parameters for call to function osal_memcpy
   \   00002F   75....       MOV     ?V0 + 0,#(aExtendedAddress & 0xff)
   \   000032   75....       MOV     ?V0 + 1,#((aExtendedAddress >> 8) & 0xff)
   \   000035   8038         SJMP    ??zb_GetDeviceInfo_11
    499                break;
    500              case ZB_INFO_SHORT_ADDR:
    501                osal_memcpy(pValue, &_NIB.nwkDevAddress, sizeof(uint16));
   \                     ??zb_GetDeviceInfo_3:
   \   000037                ; Setup parameters for call to function osal_memcpy
   \   000037   75....       MOV     ?V0 + 0,#((_NIB + 20) & 0xff)
   \   00003A   75....       MOV     ?V0 + 1,#(((_NIB + 20) >> 8) & 0xff)
   \                     ??zb_GetDeviceInfo_12:
   \   00003D   75..00       MOV     ?V0 + 2,#0x0
   \   000040   78..         MOV     R0,#?V0 + 0
   \   000042   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000045   7C02         MOV     R4,#0x2
   \   000047   8030         SJMP    ??zb_GetDeviceInfo_10
    502                break;
    503              case ZB_INFO_PARENT_SHORT_ADDR:
    504                osal_memcpy(pValue, &_NIB.nwkCoordAddress, sizeof(uint16));
   \                     ??zb_GetDeviceInfo_4:
   \   000049                ; Setup parameters for call to function osal_memcpy
   \   000049   75....       MOV     ?V0 + 0,#((_NIB + 23) & 0xff)
   \   00004C   75....       MOV     ?V0 + 1,#(((_NIB + 23) >> 8) & 0xff)
   \   00004F   80EC         SJMP    ??zb_GetDeviceInfo_12
    505                break;
    506              case ZB_INFO_PARENT_IEEE_ADDR:
    507                osal_memcpy(pValue, &_NIB.nwkCoordExtAddress, Z_EXTADDR_LEN);
   \                     ??zb_GetDeviceInfo_5:
   \   000051                ; Setup parameters for call to function osal_memcpy
   \   000051   75....       MOV     ?V0 + 0,#((_NIB + 25) & 0xff)
   \   000054   75....       MOV     ?V0 + 1,#(((_NIB + 25) >> 8) & 0xff)
   \   000057   8016         SJMP    ??zb_GetDeviceInfo_11
    508                break;
    509              case ZB_INFO_CHANNEL:
    510                osal_memcpy(pValue, &_NIB.nwkLogicalChannel, sizeof(uint8));
   \                     ??zb_GetDeviceInfo_6:
   \   000059                ; Setup parameters for call to function osal_memcpy
   \   000059   75....       MOV     ?V0 + 0,#((_NIB + 22) & 0xff)
   \   00005C   75....       MOV     ?V0 + 1,#(((_NIB + 22) >> 8) & 0xff)
   \   00005F   80C2         SJMP    ??zb_GetDeviceInfo_9
    511                break;
    512              case ZB_INFO_PAN_ID:
    513                osal_memcpy(pValue, &_NIB.nwkPanId, sizeof(uint16));
   \                     ??zb_GetDeviceInfo_7:
   \   000061                ; Setup parameters for call to function osal_memcpy
   \   000061   75....       MOV     ?V0 + 0,#((_NIB + 33) & 0xff)
   \   000064   75....       MOV     ?V0 + 1,#(((_NIB + 33) >> 8) & 0xff)
   \   000067   80D4         SJMP    ??zb_GetDeviceInfo_12
    514                break;
    515              case ZB_INFO_EXT_PAN_ID:
    516                osal_memcpy(pValue, &_NIB.extendedPANID, Z_EXTADDR_LEN);
   \                     ??zb_GetDeviceInfo_8:
   \   000069                ; Setup parameters for call to function osal_memcpy
   \   000069   75....       MOV     ?V0 + 0,#((_NIB + 53) & 0xff)
   \   00006C   75....       MOV     ?V0 + 1,#(((_NIB + 53) >> 8) & 0xff)
   \                     ??zb_GetDeviceInfo_11:
   \   00006F   75..00       MOV     ?V0 + 2,#0x0
   \   000072   78..         MOV     R0,#?V0 + 0
   \   000074   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000077   7C08         MOV     R4,#0x8
   \                     ??zb_GetDeviceInfo_10:
   \   000079   7D00         MOV     R5,#0x0
   \   00007B   12....       LCALL   ??osal_memcpy?relay
   \   00007E   7403         MOV     A,#0x3
   \   000080   12....       LCALL   ?DEALLOC_XSTACK8
    517                break;
    518            }
    519          }
   \                     ??zb_GetDeviceInfo_0:
   \   000083   02....       LJMP    ?Subroutine17 & 0xFFFF
    520          
    521          /******************************************************************************
    522           * @fn          zb_FindDeviceRequest
    523           *
    524           * @brief       The zb_FindDeviceRequest function is used to determine the
    525           *              short address for a device in the network.  The device initiating
    526           *              a call to zb_FindDeviceRequest and the device being discovered
    527           *              must both be a member of the same network.  When the search is
    528           *              complete, the zv_FindDeviceConfirm callback function is called.
    529           *
    530           * @param       searchType - The type of search to perform. Can be one of following:
    531           *                           ZB_IEEE_SEARCH - Search for 16-bit addr given IEEE addr.
    532           *              searchKey - Value to search on.
    533           *
    534           * @return      none
    535           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    536          void zb_FindDeviceRequest( uint8 searchType, void *searchKey )
   \                     zb_FindDeviceRequest:
    537          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    538            if (searchType == ZB_IEEE_SEARCH)
   \   000004   7401         MOV     A,#0x1
   \   000006   69           XRL     A,R1
   \   000007   7009         JNZ     ??zb_FindDeviceRequest_0
    539            {
    540              ZDP_NwkAddrReq((uint8*) searchKey, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
   \   000009                ; Setup parameters for call to function ZDP_NwkAddrReq
   \   000009   7D00         MOV     R5,#0x0
   \   00000B   7C00         MOV     R4,#0x0
   \   00000D   7900         MOV     R1,#0x0
   \   00000F   12....       LCALL   ??ZDP_NwkAddrReq?relay
    541            }
    542          }
   \                     ??zb_FindDeviceRequest_0:
   \   000012                REQUIRE ?Subroutine15
   \   000012                ; // Fall through to label ?Subroutine15

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    543          /******************************************************************************
    544           * @fn          SAPI_StartConfirm
    545           *
    546           * @brief       The SAPI_StartConfirm callback is called by the ZigBee stack
    547           *              after a start request operation completes
    548           *
    549           * @param       status - The status of the start operation.  Status of
    550           *                       ZB_SUCCESS indicates the start operation completed
    551           *                       successfully.  Else the status is an error code.
    552           *
    553           * @return      none
    554           */
    555          void SAPI_StartConfirm( uint8 status )
    556          {
    557          #if defined ( MT_SAPI_CB_FUNC )
    558            /* First check if MT has subscribed for this callback. If so , pass it as
    559            a event to MonitorTest and return control to calling function after that */
    560            if ( SAPICB_CHECK( SPI_CB_SAPI_START_CNF ) )
    561            {
    562              zb_MTCallbackStartConfirm( status );
    563            }
    564            else
    565          #endif  //MT_SAPI_CB_FUNC
    566            {
    567          #if ( SAPI_CB_FUNC )
    568              zb_StartConfirm( status );
    569          #endif
    570            }
    571          }
    572          
    573          /******************************************************************************
    574           * @fn          SAPI_SendDataConfirm
    575           *
    576           * @brief       The SAPI_SendDataConfirm callback function is called by the
    577           *              ZigBee after a send data operation completes
    578           *
    579           * @param       handle - The handle identifying the data transmission.
    580           *              status - The status of the operation.
    581           *
    582           * @return      none
    583           */
    584          void SAPI_SendDataConfirm( uint8 handle, uint8 status )
    585          {
    586          #if defined ( MT_SAPI_CB_FUNC )
    587            /* First check if MT has subscribed for this callback. If so , pass it as
    588            a event to MonitorTest and return control to calling function after that */
    589            if ( SAPICB_CHECK( SPI_CB_SAPI_SEND_DATA_CNF ) )
    590            {
    591              zb_MTCallbackSendDataConfirm( handle, status );
    592            }
    593            else
    594          #endif  //MT_SAPI_CB_FUNC
    595            {
    596          #if ( SAPI_CB_FUNC )
    597              zb_SendDataConfirm( handle, status );
    598          #endif
    599            }
    600          }
    601          
    602          /******************************************************************************
    603           * @fn          SAPI_BindConfirm
    604           *
    605           * @brief       The SAPI_BindConfirm callback is called by the ZigBee stack
    606           *              after a bind operation completes.
    607           *
    608           * @param       commandId - The command ID of the binding being confirmed.
    609           *              status - The status of the bind operation.
    610           *              allowBind - TRUE if the bind operation was initiated by a call
    611           *                          to zb_AllowBindRespones.  FALSE if the operation
    612           *                          was initiated by a call to ZB_BindDevice
    613           *
    614           * @return      none
    615           */
    616          void SAPI_BindConfirm( uint16 commandId, uint8 status )
    617          {
    618          #if defined ( MT_SAPI_CB_FUNC )
    619            /* First check if MT has subscribed for this callback. If so , pass it as
    620            a event to MonitorTest and return control to calling function after that */
    621            if ( SAPICB_CHECK( SPI_CB_SAPI_BIND_CNF ) )
    622            {
    623              zb_MTCallbackBindConfirm( commandId, status );
    624            }
    625            else
    626          #endif  //MT_SAPI_CB_FUNC
    627            {
    628          #if ( SAPI_CB_FUNC )
    629              zb_BindConfirm( commandId, status );
    630          #endif
    631            }
    632          }
    633          /******************************************************************************
    634           * @fn          SAPI_AllowBindConfirm
    635           *
    636           * @brief       Indicates when another device attempted to bind to this device
    637           *
    638           * @param
    639           *
    640           * @return      none
    641           */
    642          void SAPI_AllowBindConfirm( uint16 source )
    643          {
    644            #if defined ( MT_SAPI_CB_FUNC )
    645            /* First check if MT has subscribed for this callback. If so , pass it as
    646            a event to MonitorTest and return control to calling function after that */
    647            if ( SAPICB_CHECK( SPI_CB_SAPI_ALLOW_BIND_CNF ) )
    648            {
    649              zb_MTCallbackAllowBindConfirm( source );
    650            }
    651            else
    652          #endif  //MT_SAPI_CB_FUNC
    653            {
    654          #if ( SAPI_CB_FUNC )
    655              zb_AllowBindConfirm( source );
    656          #endif
    657            }
    658          }
    659          /******************************************************************************
    660           * @fn          SAPI_FindDeviceConfirm
    661           *
    662           * @brief       The SAPI_FindDeviceConfirm callback function is called by the
    663           *              ZigBee stack when a find device operation completes.
    664           *
    665           * @param       searchType - The type of search that was performed.
    666           *              searchKey - Value that the search was executed on.
    667           *              result - The result of the search.
    668           *
    669           * @return      none
    670           */
    671          void SAPI_FindDeviceConfirm( uint8 searchType, uint8 *searchKey, uint8 *result )
    672          {
    673          #if defined ( MT_SAPI_CB_FUNC )
    674            /* First check if MT has subscribed for this callback. If so , pass it as
    675            a event to MonitorTest and return control to calling function after that */
    676            if ( SAPICB_CHECK( SPI_CB_SAPI_FIND_DEV_CNF ) )
    677            {
    678              zb_MTCallbackFindDeviceConfirm( searchType, searchKey, result );
    679            }
    680            else
    681          #endif  //MT_SAPI_CB_FUNC
    682            {
    683          #if ( SAPI_CB_FUNC )
    684              zb_FindDeviceConfirm( searchType, searchKey, result );
    685          #endif
    686            }
    687          }
    688          /******************************************************************************
    689           * @fn          SAPI_ReceiveDataIndication
    690           *
    691           * @brief       The SAPI_ReceiveDataIndication callback function is called
    692           *              asynchronously by the ZigBee stack to notify the application
    693           *              when data is received from a peer device.
    694           *
    695           * @param       source - The short address of the peer device that sent the data
    696           *              command - The commandId associated with the data
    697           *              len - The number of bytes in the pData parameter
    698           *              pData - The data sent by the peer device
    699           *
    700           * @return      none
    701           */
    702          void SAPI_ReceiveDataIndication( uint16 source, uint16 command, uint16 len, uint8 *pData  )
    703          {
    704          #if defined ( MT_SAPI_CB_FUNC )
    705            /* First check if MT has subscribed for this callback. If so , pass it as
    706            a event to MonitorTest and return control to calling function after that */
    707            if ( SAPICB_CHECK( SPI_CB_SAPI_RCV_DATA_IND ) )
    708            {
    709              zb_MTCallbackReceiveDataIndication( source, command, len, pData  );
    710            }
    711            else
    712          #endif  //MT_SAPI_CB_FUNC
    713            {
    714          #if ( SAPI_CB_FUNC )
    715              zb_ReceiveDataIndication( source, command, len, pData  );
    716          #endif
    717            }
    718          }
    719          /*********************************************************************
    720           * @fn      SAPI_ProcessEvent
    721           *
    722           * @brief   Simple API Task event processor.  This function
    723           *          is called to process all events for the task.  Events
    724           *          include timers, messages and any other user defined events.
    725           *
    726           * @param   task_id  - The OSAL assigned task ID.
    727           * @param   events - events to process.  This is a bit map and can
    728           *                   contain more than one event.
    729           *
    730           * @return  none
    731           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    732          UINT16 SAPI_ProcessEvent( byte task_id, UINT16 events )
   \                     SAPI_ProcessEvent:
    733          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   89..         MOV     ?V0 + 2,R1
   \   00000C   8A..         MOV     ?V0 + 0,R2
   \   00000E   8B..         MOV     ?V0 + 1,R3
    734            osal_event_hdr_t *pMsg;
    735            afIncomingMSGPacket_t *pMSGpkt;
    736            afDataConfirm_t *pDataConfirm;
    737          
    738            if ( events & SYS_EVENT_MSG )
   \   000010   7480         MOV     A,#-0x80
   \   000012   55..         ANL     A,?V0 + 1
   \   000014   F9           MOV     R1,A
   \   000015   E4           CLR     A
   \   000016   7001         JNZ     ??SAPI_ProcessEvent_0
   \   000018   E9           MOV     A,R1
   \                     ??SAPI_ProcessEvent_0:
   \   000019   7003         JNZ     $+5
   \   00001B   02....       LJMP    ??SAPI_ProcessEvent_1 & 0xFFFF
    739            {
    740              pMsg = (osal_event_hdr_t *) osal_msg_receive( task_id );
   \   00001E                ; Setup parameters for call to function osal_msg_receive
   \   00001E   8010         SJMP    ??SAPI_ProcessEvent_2
    741              while ( pMsg )
    742              {
    743                switch ( pMsg->event )
    744                {
    745                  case ZDO_CB_MSG:
    746                    SAPI_ProcessZDOMsgs( (zdoIncomingMsg_t *)pMsg );
    747                    break;
    748          
    749                  case AF_DATA_CONFIRM_CMD:
    750                    // This message is received as a confirmation of a data packet sent.
    751                    // The status is of ZStatus_t type [defined in ZComDef.h]
    752                    // The message fields are defined in AF.h
    753                    pDataConfirm = (afDataConfirm_t *) pMsg;
    754                    SAPI_SendDataConfirm( pDataConfirm->transID, pDataConfirm->hdr.status );
    755                    break;
    756          
    757                  case AF_INCOMING_MSG_CMD:
    758                    pMSGpkt = (afIncomingMSGPacket_t *) pMsg;
    759                    SAPI_ReceiveDataIndication( pMSGpkt->srcAddr.addr.shortAddr, pMSGpkt->clusterId,
    760                                              pMSGpkt->cmd.DataLength, pMSGpkt->cmd.Data);
    761                    break;
    762          
    763                  case ZDO_STATE_CHANGE:
    764                    // If the device has started up, notify the application
    765                    if (pMsg->status == DEV_END_DEVICE ||
    766                        pMsg->status == DEV_ROUTER ||
    767                        pMsg->status == DEV_ZB_COORD )
    768                    {
    769                      SAPI_StartConfirm( ZB_SUCCESS );
    770                    }
    771                    else  if (pMsg->status == DEV_HOLD ||
    772                            pMsg->status == DEV_INIT)
    773                    {
    774                      SAPI_StartConfirm( ZB_INIT );
    775                    }
    776                    break;
    777          
    778                  case ZDO_MATCH_DESC_RSP_SENT:
    779                    SAPI_AllowBindConfirm( ((ZDO_MatchDescRspSent_t *)pMsg)->nwkAddr );
    780                    break;
    781          
    782                  case KEY_CHANGE:
    783          #if ( SAPI_CB_FUNC )
    784                    zb_HandleKeys( ((keyChange_t *)pMsg)->state, ((keyChange_t *)pMsg)->keys );
    785          #endif
    786                    break;
    787          
    788                  case SAPICB_DATA_CNF:
    789                    SAPI_SendDataConfirm( (uint8)((sapi_CbackEvent_t *)pMsg)->data,
    790                                              ((sapi_CbackEvent_t *)pMsg)->hdr.status );
    791                    break;
    792          
    793                  case SAPICB_BIND_CNF:
    794                    SAPI_BindConfirm( ((sapi_CbackEvent_t *)pMsg)->data,
    795                                        ((sapi_CbackEvent_t *)pMsg)->hdr.status );
    796                    break;
    797          
    798                  case SAPICB_START_CNF:
    799                    SAPI_StartConfirm( ((sapi_CbackEvent_t *)pMsg)->hdr.status );
   \                     ??SAPI_ProcessEvent_3:
   \   000020                ; Setup parameters for call to function zb_StartConfirm
   \   000020   8882         MOV     DPL,R0
   \   000022   8983         MOV     DPH,R1
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F9           MOV     R1,A
   \                     ??SAPI_ProcessEvent_4:
   \   000026   12....       LCALL   ??zb_StartConfirm?relay
    800                    break;
    801          
    802                  default:
    803                    // User messages should be handled by user or passed to the application
    804                    if ( pMsg->event >= ZB_USER_MSG )
    805                    {
    806          
    807                    }
    808                    break;
    809                }
    810          
    811                // Release the memory
    812                osal_msg_deallocate( (uint8 *) pMsg );
   \                     ??SAPI_ProcessEvent_5:
   \   000029                ; Setup parameters for call to function osal_msg_deallocate
   \   000029   EE           MOV     A,R6
   \   00002A   FA           MOV     R2,A
   \   00002B   EF           MOV     A,R7
   \   00002C   FB           MOV     R3,A
   \   00002D   12....       LCALL   ??osal_msg_deallocate?relay
    813          
    814                // Next
    815                pMsg = (osal_event_hdr_t *) osal_msg_receive( task_id );
   \   000030                ; Setup parameters for call to function osal_msg_receive
   \                     ??SAPI_ProcessEvent_2:
   \   000030   A9..         MOV     R1,?V0 + 2
   \   000032   12....       LCALL   ??osal_msg_receive?relay
   \   000035   8A..         MOV     ?V0 + 4,R2
   \   000037   8B..         MOV     ?V0 + 5,R3
   \   000039   AE..         MOV     R6,?V0 + 4
   \   00003B   AF..         MOV     R7,?V0 + 5
   \   00003D   EE           MOV     A,R6
   \   00003E   7001         JNZ     ??SAPI_ProcessEvent_6
   \   000040   EF           MOV     A,R7
   \                     ??SAPI_ProcessEvent_6:
   \   000041   7003         JNZ     $+5
   \   000043   02....       LJMP    ??SAPI_ProcessEvent_7 & 0xFFFF
   \   000046   EE           MOV     A,R6
   \   000047   2403         ADD     A,#0x3
   \   000049   F8           MOV     R0,A
   \   00004A   EF           MOV     A,R7
   \   00004B   3400         ADDC    A,#0x0
   \   00004D   F9           MOV     R1,A
   \   00004E   88..         MOV     ?V0 + 4,R0
   \   000050   89..         MOV     ?V0 + 5,R1
   \   000052   EE           MOV     A,R6
   \   000053   2402         ADD     A,#0x2
   \   000055   18           DEC     R0
   \   000056   EF           MOV     A,R7
   \   000057   3400         ADDC    A,#0x0
   \   000059   F9           MOV     R1,A
   \   00005A   E8           MOV     A,R0
   \   00005B   FC           MOV     R4,A
   \   00005C   E9           MOV     A,R1
   \   00005D   FD           MOV     R5,A
   \   00005E   8E82         MOV     DPL,R6
   \   000060   8F83         MOV     DPH,R7
   \   000062   A3           INC     DPTR
   \   000063   A882         MOV     R0,DPL
   \   000065   A983         MOV     R1,DPH
   \   000067   8E82         MOV     DPL,R6
   \   000069   8F83         MOV     DPH,R7
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   12....       LCALL   ?UC_SWITCH_SPARSE
   \                     `?<Jumptable for SAPI_ProcessEvent>_0`:
   \   00006F   00           DB        0
   \   000070   09           DB        9
   \   000071   1A           DB        26
   \   000072   ....         DW        ??SAPI_ProcessEvent_8
   \   000074   C0           DB        192
   \   000075   ....         DW        ??SAPI_ProcessEvent_9
   \   000077   D1           DB        209
   \   000078   ....         DW        ??SAPI_ProcessEvent_10
   \   00007A   D2           DB        210
   \   00007B   ....         DW        ??SAPI_ProcessEvent_11
   \   00007D   D3           DB        211
   \   00007E   ....         DW        ??SAPI_ProcessEvent_12
   \   000080   E0           DB        224
   \   000081   ....         DW        ??SAPI_ProcessEvent_13
   \   000083   E1           DB        225
   \   000084   ....         DW        ??SAPI_ProcessEvent_14
   \   000086   E2           DB        226
   \   000087   ....         DW        ??SAPI_ProcessEvent_3
   \   000089   FD           DB        253
   \   00008A   ....         DW        ??SAPI_ProcessEvent_15
   \   00008C   ....         DW        ??SAPI_ProcessEvent_5
   \                     ??SAPI_ProcessEvent_12:
   \   00008E                ; Setup parameters for call to function SAPI_ProcessZDOMsgs
   \   00008E   EE           MOV     A,R6
   \   00008F   FA           MOV     R2,A
   \   000090   EF           MOV     A,R7
   \   000091   FB           MOV     R3,A
   \   000092   12....       LCALL   ??SAPI_ProcessZDOMsgs?relay
   \   000095   8092         SJMP    ??SAPI_ProcessEvent_5
   \                     ??SAPI_ProcessEvent_15:
   \   000097                ; Setup parameters for call to function zb_SendDataConfirm
   \   000097   8882         MOV     DPL,R0
   \   000099   8983         MOV     DPH,R1
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   FA           MOV     R2,A
   \   00009D   85..82       MOV     DPL,?V0 + 4
   \   0000A0   85..83       MOV     DPH,?V0 + 5
   \                     ??SAPI_ProcessEvent_16:
   \   0000A3   E0           MOVX    A,@DPTR
   \   0000A4   F9           MOV     R1,A
   \   0000A5   12....       LCALL   ??zb_SendDataConfirm?relay
   \   0000A8   02....       LJMP    ??SAPI_ProcessEvent_5 & 0xFFFF
   \                     ??SAPI_ProcessEvent_8:
   \   0000AB                ; Setup parameters for call to function zb_ReceiveDataIndication
   \   0000AB   EE           MOV     A,R6
   \   0000AC   2421         ADD     A,#0x21
   \   0000AE   F582         MOV     DPL,A
   \   0000B0   EF           MOV     A,R7
   \   0000B1   3400         ADDC    A,#0x0
   \   0000B3   F583         MOV     DPH,A
   \   0000B5   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000B8   EE           MOV     A,R6
   \   0000B9   241F         ADD     A,#0x1f
   \   0000BB   F582         MOV     DPL,A
   \   0000BD   EF           MOV     A,R7
   \   0000BE   3400         ADDC    A,#0x0
   \   0000C0   F583         MOV     DPH,A
   \   0000C2   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000C5   8E82         MOV     DPL,R6
   \   0000C7   8F83         MOV     DPH,R7
   \   0000C9   A3           INC     DPTR
   \   0000CA   A3           INC     DPTR
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   E0           MOVX    A,@DPTR
   \   0000CE   FC           MOV     R4,A
   \   0000CF   A3           INC     DPTR
   \   0000D0   E0           MOVX    A,@DPTR
   \   0000D1   FD           MOV     R5,A
   \   0000D2   8E82         MOV     DPL,R6
   \   0000D4   8F83         MOV     DPH,R7
   \   0000D6   A3           INC     DPTR
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   A3           INC     DPTR
   \   0000DA   A3           INC     DPTR
   \   0000DB   A3           INC     DPTR
   \   0000DC   12....       LCALL   ??Subroutine20_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   0000DF   12....       LCALL   ??zb_ReceiveDataIndication?relay
   \   0000E2   7404         MOV     A,#0x4
   \   0000E4   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E7   02....       LJMP    ??SAPI_ProcessEvent_5 & 0xFFFF
   \                     ??SAPI_ProcessEvent_10:
   \   0000EA   8E82         MOV     DPL,R6
   \   0000EC   8F83         MOV     DPH,R7
   \   0000EE   A3           INC     DPTR
   \   0000EF   E0           MOVX    A,@DPTR
   \   0000F0   6406         XRL     A,#0x6
   \   0000F2   600A         JZ      ??SAPI_ProcessEvent_17
   \   0000F4   E0           MOVX    A,@DPTR
   \   0000F5   6407         XRL     A,#0x7
   \   0000F7   6005         JZ      ??SAPI_ProcessEvent_17
   \   0000F9   E0           MOVX    A,@DPTR
   \   0000FA   6409         XRL     A,#0x9
   \   0000FC   7005         JNZ     ??SAPI_ProcessEvent_18
   \                     ??SAPI_ProcessEvent_17:
   \   0000FE                ; Setup parameters for call to function zb_StartConfirm
   \   0000FE   7900         MOV     R1,#0x0
   \   000100   02....       LJMP    ??SAPI_ProcessEvent_4 & 0xFFFF
   \                     ??SAPI_ProcessEvent_18:
   \   000103   E0           MOVX    A,@DPTR
   \   000104   6007         JZ      ??SAPI_ProcessEvent_19
   \   000106   6401         XRL     A,#0x1
   \   000108   6003         JZ      $+5
   \   00010A   02....       LJMP    ??SAPI_ProcessEvent_5 & 0xFFFF
   \                     ??SAPI_ProcessEvent_19:
   \   00010D                ; Setup parameters for call to function zb_StartConfirm
   \   00010D   7922         MOV     R1,#0x22
   \   00010F   02....       LJMP    ??SAPI_ProcessEvent_4 & 0xFFFF
   \                     ??SAPI_ProcessEvent_11:
   \   000112                ; Setup parameters for call to function zb_AllowBindConfirm
   \   000112   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_31:
   \   000115   12....       LCALL   ??zb_AllowBindConfirm?relay
   \   000118   02....       LJMP    ??SAPI_ProcessEvent_5 & 0xFFFF
   \                     ??SAPI_ProcessEvent_9:
   \   00011B                ; Setup parameters for call to function zb_HandleKeys
   \   00011B   85..82       MOV     DPL,?V0 + 4
   \   00011E   85..83       MOV     DPH,?V0 + 5
   \   000121   E0           MOVX    A,@DPTR
   \   000122   FA           MOV     R2,A
   \   000123   8C82         MOV     DPL,R4
   \   000125   8D83         MOV     DPH,R5
   \   000127   E0           MOVX    A,@DPTR
   \   000128   F9           MOV     R1,A
   \   000129   12....       LCALL   ??zb_HandleKeys?relay
   \   00012C   02....       LJMP    ??SAPI_ProcessEvent_5 & 0xFFFF
   \                     ??SAPI_ProcessEvent_13:
   \   00012F                ; Setup parameters for call to function zb_SendDataConfirm
   \   00012F   8882         MOV     DPL,R0
   \   000131   8983         MOV     DPH,R1
   \   000133   E0           MOVX    A,@DPTR
   \   000134   FA           MOV     R2,A
   \   000135   8C82         MOV     DPL,R4
   \   000137   8D83         MOV     DPH,R5
   \   000139   02....       LJMP    ??SAPI_ProcessEvent_16 & 0xFFFF
   \                     ??SAPI_ProcessEvent_14:
   \   00013C                ; Setup parameters for call to function zb_BindConfirm
   \   00013C   8882         MOV     DPL,R0
   \   00013E   8983         MOV     DPH,R1
   \   000140   E0           MOVX    A,@DPTR
   \   000141   F9           MOV     R1,A
   \   000142   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   000145   12....       LCALL   ??zb_BindConfirm?relay
    816              }
   \   000148   02....       LJMP    ??SAPI_ProcessEvent_5 & 0xFFFF
    817          
    818              // Return unprocessed events
    819              return (events ^ SYS_EVENT_MSG);
   \                     ??SAPI_ProcessEvent_7:
   \   00014B   AA..         MOV     R2,?V0 + 0
   \   00014D   7480         MOV     A,#-0x80
   \                     ??SAPI_ProcessEvent_20:
   \   00014F   65..         XRL     A,?V0 + 1
   \   000151   FB           MOV     R3,A
   \   000152   807A         SJMP    ??SAPI_ProcessEvent_21
    820            }
    821          
    822            if ( events & ZB_ALLOW_BIND_TIMER )
   \                     ??SAPI_ProcessEvent_1:
   \   000154   7440         MOV     A,#0x40
   \   000156   55..         ANL     A,?V0 + 1
   \   000158   F9           MOV     R1,A
   \   000159   E4           CLR     A
   \   00015A   7001         JNZ     ??SAPI_ProcessEvent_22
   \   00015C   E9           MOV     A,R1
   \                     ??SAPI_ProcessEvent_22:
   \   00015D   6009         JZ      ??SAPI_ProcessEvent_23
    823            {
    824              afSetMatch(sapi_epDesc.simpleDesc->EndPoint, FALSE);
   \   00015F                ; Setup parameters for call to function afSetMatch
   \   00015F   12....       LCALL   ?Subroutine4 & 0xFFFF
    825              return (events ^ ZB_ALLOW_BIND_TIMER);
   \                     ??CrossCallReturnLabel_8:
   \   000162   AA..         MOV     R2,?V0 + 0
   \   000164   7440         MOV     A,#0x40
   \   000166   80E7         SJMP    ??SAPI_ProcessEvent_20
    826            }
    827          
    828            if ( events & ZB_BIND_TIMER )
   \                     ??SAPI_ProcessEvent_23:
   \   000168   7420         MOV     A,#0x20
   \   00016A   55..         ANL     A,?V0 + 1
   \   00016C   F9           MOV     R1,A
   \   00016D   E4           CLR     A
   \   00016E   7001         JNZ     ??SAPI_ProcessEvent_24
   \   000170   E9           MOV     A,R1
   \                     ??SAPI_ProcessEvent_24:
   \   000171   600B         JZ      ??SAPI_ProcessEvent_25
    829            {
    830              // Send bind confirm callback to application
    831              SAPI_BindConfirm( sapi_bindInProgress, ZB_TIMEOUT );
   \   000173                ; Setup parameters for call to function zb_BindConfirm
   \   000173   7921         MOV     R1,#0x21
   \   000175   12....       LCALL   ?Subroutine2 & 0xFFFF
    832              sapi_bindInProgress = 0xffff;
    833          
    834              return (events ^ ZB_BIND_TIMER);
   \                     ??CrossCallReturnLabel_4:
   \   000178   AA..         MOV     R2,?V0 + 0
   \   00017A   7420         MOV     A,#0x20
   \   00017C   80D1         SJMP    ??SAPI_ProcessEvent_20
    835            }
    836          
    837            if ( events & ZB_ENTRY_EVENT )
   \                     ??SAPI_ProcessEvent_25:
   \   00017E   7410         MOV     A,#0x10
   \   000180   55..         ANL     A,?V0 + 1
   \   000182   F9           MOV     R1,A
   \   000183   E4           CLR     A
   \   000184   7001         JNZ     ??SAPI_ProcessEvent_26
   \   000186   E9           MOV     A,R1
   \                     ??SAPI_ProcessEvent_26:
   \   000187   603B         JZ      ??SAPI_ProcessEvent_27
    838            {
    839              uint8 startOptions;
    840          
    841              // Give indication to application of device startup
    842          #if ( SAPI_CB_FUNC )
    843              zb_HandleOsalEvent( ZB_ENTRY_EVENT );
   \   000189                ; Setup parameters for call to function zb_HandleOsalEvent
   \   000189   7A00         MOV     R2,#0x0
   \   00018B   7B10         MOV     R3,#0x10
   \   00018D   12....       LCALL   ??zb_HandleOsalEvent?relay
    844          #endif
    845          
    846              // LED off cancels HOLD_AUTO_START blink set in the stack
    847              HalLedSet (HAL_LED_4, HAL_LED_MODE_OFF);
   \   000190                ; Setup parameters for call to function HalLedSet
   \   000190   7A00         MOV     R2,#0x0
   \   000192   7908         MOV     R1,#0x8
   \   000194   12....       LCALL   ??HalLedSet?relay
    848          
    849              zb_ReadConfiguration( ZCD_NV_STARTUP_OPTION, sizeof(uint8), &startOptions );
   \   000197                ; Setup parameters for call to function zb_ReadConfiguration
   \   000197   85..82       MOV     DPL,?XSP + 0
   \   00019A   85..83       MOV     DPH,?XSP + 1
   \   00019D   AC82         MOV     R4,DPL
   \   00019F   AD83         MOV     R5,DPH
   \   0001A1   7A01         MOV     R2,#0x1
   \   0001A3   7903         MOV     R1,#0x3
   \   0001A5   12....       LCALL   ?Subroutine0 & 0xFFFF
    850              if ( startOptions & ZCD_STARTOPT_AUTO_START )
   \                     ??CrossCallReturnLabel_1:
   \   0001A8   A2E2         MOV     C,0xE0 /* A   */.2
   \   0001AA   5005         JNC     ??SAPI_ProcessEvent_28
    851              {
    852                zb_StartRequest();
   \   0001AC                ; Setup parameters for call to function zb_StartRequest
   \   0001AC   12....       LCALL   ??zb_StartRequest?relay
   \   0001AF   800D         SJMP    ??SAPI_ProcessEvent_29
    853              }
    854              else
    855              {
    856                // blink leds and wait for external input to config and restart
    857                HalLedBlink(HAL_LED_2, 0, 50, 500);
   \                     ??SAPI_ProcessEvent_28:
   \   0001B1                ; Setup parameters for call to function HalLedBlink
   \   0001B1   7CF4         MOV     R4,#-0xc
   \   0001B3   7D01         MOV     R5,#0x1
   \   0001B5   7B32         MOV     R3,#0x32
   \   0001B7   7A00         MOV     R2,#0x0
   \   0001B9   7902         MOV     R1,#0x2
   \   0001BB   12....       LCALL   ??HalLedBlink?relay
    858              }
    859          
    860              return (events ^ ZB_ENTRY_EVENT );
   \                     ??SAPI_ProcessEvent_29:
   \   0001BE   AA..         MOV     R2,?V0 + 0
   \   0001C0   7410         MOV     A,#0x10
   \   0001C2   808B         SJMP    ??SAPI_ProcessEvent_20
    861            }
    862          
    863            // This must be the last event to be processed
    864            if ( events & ( ZB_USER_EVENTS ) )
   \                     ??SAPI_ProcessEvent_27:
   \   0001C4   EA           MOV     A,R2
   \   0001C5   6003         JZ      ??SAPI_ProcessEvent_30
    865            {
    866              // User events are passed to the application
    867          #if ( SAPI_CB_FUNC )
    868              zb_HandleOsalEvent( events );
   \   0001C7                ; Setup parameters for call to function zb_HandleOsalEvent
   \   0001C7   12....       LCALL   ??zb_HandleOsalEvent?relay
    869          #endif
    870          
    871              // Do not return here, return 0 later
    872            }
    873          
    874            // Discard unknown events 
    875            return 0;
   \                     ??SAPI_ProcessEvent_30:
   \   0001CA   7A00         MOV     R2,#0x0
   \   0001CC   7B00         MOV     R3,#0x0
   \                     ??SAPI_ProcessEvent_21:
   \   0001CE   7401         MOV     A,#0x1
   \   0001D0   02....       LJMP    ?Subroutine16 & 0xFFFF
    876          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   90....       MOV     DPTR,#sapi_bindInProgress
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FA           MOV     R2,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FB           MOV     R3,A
   \   000008   12....       LCALL   ??zb_BindConfirm?relay
   \   00000B   90....       MOV     DPTR,#sapi_bindInProgress
   \   00000E   74FF         MOV     A,#-0x1
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   F0           MOVX    @DPTR,A
   \   000013   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7A00         MOV     R2,#0x0
   \   000002   12....       LCALL   ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   000005   12....       LCALL   ??afSetMatch?relay
   \   000008   22           RET
    877          
    878          /*********************************************************************
    879           * @fn      SAPI_ProcessZDOMsgs()
    880           *
    881           * @brief   Process response messages
    882           *
    883           * @param   none
    884           *
    885           * @return  none
    886           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    887          void SAPI_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg )
   \                     SAPI_ProcessZDOMsgs:
    888          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    889            switch ( inMsg->clusterID )
   \   00000A   EA           MOV     A,R2
   \   00000B   240C         ADD     A,#0xc
   \   00000D   F582         MOV     DPL,A
   \   00000F   EB           MOV     A,R3
   \   000010   3400         ADDC    A,#0x0
   \   000012   F583         MOV     DPH,A
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 0,A
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 1,A
   \   00001B   78..         MOV     R0,#?V0 + 0
   \   00001D   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for SAPI_ProcessZDOMsgs>_0`:
   \   000020   0000         DW        0
   \   000022   0200         DW        2
   \   000024   0080         DW        32768
   \   000026   ....         DW        ??SAPI_ProcessZDOMsgs_0
   \   000028   0680         DW        32774
   \   00002A   ....         DW        ??SAPI_ProcessZDOMsgs_1
   \   00002C   ....         DW        ??CrossCallReturnLabel_5
    890            {
    891              case NWK_addr_rsp:
    892                {
    893                  // Send find device callback to application
    894                  ZDO_NwkIEEEAddrResp_t *pNwkAddrRsp = ZDO_ParseAddrRsp( inMsg );
   \                     ??SAPI_ProcessZDOMsgs_0:
   \   00002E                ; Setup parameters for call to function ZDO_ParseAddrRsp
   \   00002E   12....       LCALL   ??ZDO_ParseAddrRsp?relay
   \   000031   8A82         MOV     DPL,R2
   \   000033   8B83         MOV     DPH,R3
    895                  SAPI_FindDeviceConfirm( ZB_IEEE_SEARCH, (uint8*)&pNwkAddrRsp->nwkAddr, pNwkAddrRsp->extAddr );
   \   000035                ; Setup parameters for call to function zb_FindDeviceConfirm
   \   000035   E582         MOV     A,DPL
   \   000037   2403         ADD     A,#0x3
   \   000039   FC           MOV     R4,A
   \   00003A   E583         MOV     A,DPH
   \   00003C   3400         ADDC    A,#0x0
   \   00003E   FD           MOV     R5,A
   \   00003F   A3           INC     DPTR
   \   000040   AA82         MOV     R2,DPL
   \   000042   AB83         MOV     R3,DPH
   \   000044   7901         MOV     R1,#0x1
   \   000046   12....       LCALL   ??zb_FindDeviceConfirm?relay
    896                }
   \   000049   807A         SJMP    ??CrossCallReturnLabel_5
    897                break;
    898          
    899              case Match_Desc_rsp:
    900                {
    901                  zAddrType_t dstAddr;
    902                  ZDO_ActiveEndpointRsp_t *pRsp = ZDO_ParseEPListRsp( inMsg );
   \                     ??SAPI_ProcessZDOMsgs_1:
   \   00004B                ; Setup parameters for call to function ZDO_ParseEPListRsp
   \   00004B   12....       LCALL   ??ZDO_ParseEPListRsp?relay
    903          
    904                  if ( sapi_bindInProgress != 0xffff )
   \   00004E   90....       MOV     DPTR,#sapi_bindInProgress
   \   000051   E0           MOVX    A,@DPTR
   \   000052   64FF         XRL     A,#0xff
   \   000054   7004         JNZ     ??SAPI_ProcessZDOMsgs_2
   \   000056   A3           INC     DPTR
   \   000057   E0           MOVX    A,@DPTR
   \   000058   64FF         XRL     A,#0xff
   \                     ??SAPI_ProcessZDOMsgs_2:
   \   00005A   6069         JZ      ??CrossCallReturnLabel_5
    905                  {
    906                    // Create a binding table entry
    907                    dstAddr.addrMode = Addr16Bit;
   \   00005C   7408         MOV     A,#0x8
   \   00005E   12....       LCALL   ?XSTACK_DISP0_8
   \   000061   7402         MOV     A,#0x2
   \   000063   12....       LCALL   ?Subroutine9 & 0xFFFF
    908                    dstAddr.addr.shortAddr = pRsp->nwkAddr;
   \                     ??CrossCallReturnLabel_14:
   \   000066   AE82         MOV     R6,DPL
   \   000068   AF83         MOV     R7,DPH
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   F8           MOV     R0,A
   \   00006C   A3           INC     DPTR
   \   00006D   E0           MOVX    A,@DPTR
   \   00006E   F9           MOV     R1,A
   \   00006F   85..82       MOV     DPL,?XSP + 0
   \   000072   85..83       MOV     DPH,?XSP + 1
   \   000075   E8           MOV     A,R0
   \   000076   F0           MOVX    @DPTR,A
   \   000077   A3           INC     DPTR
   \   000078   E9           MOV     A,R1
   \   000079   12....       LCALL   ?Subroutine9 & 0xFFFF
    909          
    910                    if ( APSME_BindRequest( sapi_epDesc.simpleDesc->EndPoint,
    911                               sapi_bindInProgress, &dstAddr, pRsp->epList[0] ) == ZSuccess )
   \                     ??CrossCallReturnLabel_15:
   \   00007C   A3           INC     DPTR
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   F5..         MOV     ?V0 + 0,A
   \   000082   78..         MOV     R0,#?V0 + 0
   \   000084   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000087   7401         MOV     A,#0x1
   \   000089   12....       LCALL   ?XSTACK_DISP0_8
   \   00008C   AC82         MOV     R4,DPL
   \   00008E   AD83         MOV     R5,DPH
   \   000090   90....       MOV     DPTR,#sapi_bindInProgress
   \   000093   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   000096   12....       LCALL   ??APSME_BindRequest?relay
   \   000099   7401         MOV     A,#0x1
   \   00009B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00009E   E9           MOV     A,R1
   \   00009F   7024         JNZ     ??CrossCallReturnLabel_5
    912                    {
    913                      osal_stop_timerEx(sapi_TaskID,  ZB_BIND_TIMER);
   \   0000A1                ; Setup parameters for call to function osal_stop_timerEx
   \   0000A1   7A00         MOV     R2,#0x0
   \   0000A3   7B20         MOV     R3,#0x20
   \   0000A5   90....       MOV     DPTR,#sapi_TaskID
   \   0000A8   E0           MOVX    A,@DPTR
   \   0000A9   F9           MOV     R1,A
   \   0000AA   12....       LCALL   ??osal_stop_timerEx?relay
    914                      osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, 250 );
   \   0000AD                ; Setup parameters for call to function osal_start_timerEx
   \   0000AD   12....       LCALL   ?Subroutine5 & 0xFFFF
    915          
    916                      // Find IEEE addr
    917                      ZDP_IEEEAddrReq( pRsp->nwkAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
   \                     ??CrossCallReturnLabel_25:
   \   0000B0                ; Setup parameters for call to function ZDP_IEEEAddrReq
   \   0000B0   7D00         MOV     R5,#0x0
   \   0000B2   7C00         MOV     R4,#0x0
   \   0000B4   7900         MOV     R1,#0x0
   \   0000B6   8E82         MOV     DPL,R6
   \   0000B8   8F83         MOV     DPH,R7
   \   0000BA   12....       LCALL   ??Subroutine20_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_30:
   \   0000BD   12....       LCALL   ??ZDP_IEEEAddrReq?relay
    918          #if defined ( MT_SAPI_CB_FUNC )
    919                      zb_MTCallbackBindConfirm( sapi_bindInProgress, ZB_SUCCESS );
    920          #endif              
    921                      // Send bind confirm callback to application
    922          #if ( SAPI_CB_FUNC )
    923                      zb_BindConfirm( sapi_bindInProgress, ZB_SUCCESS );
   \   0000C0                ; Setup parameters for call to function zb_BindConfirm
   \   0000C0   7900         MOV     R1,#0x0
   \   0000C2   12....       LCALL   ?Subroutine2 & 0xFFFF
    924          #endif
    925                      sapi_bindInProgress = 0xffff;
    926                    }
    927                  }
    928                }
    929                break;
    930            }
    931          }
   \                     ??CrossCallReturnLabel_5:
   \   0000C5   7409         MOV     A,#0x9
   \   0000C7   02....       LJMP    ?Subroutine14 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function APSME_BindRequest
   \   000001   8A82         MOV     DPL,R2
   \   000003   8B83         MOV     DPH,R3
   \   000005   A3           INC     DPTR
   \   000006   22           RET
    932          
    933          /*********************************************************************
    934           * @fn      SAPI_Init
    935           *
    936           * @brief   Initialization function for the Simple API Task.
    937           *          This is called during initialization and should contain
    938           *          any application specific initialization (ie. hardware
    939           *          initialization/setup, table initialization, power up
    940           *          notification ... ).
    941           *
    942           * @param   task_id - the ID assigned by OSAL.  This ID should be
    943           *                    used to send messages and set timers.
    944           *
    945           * @return  none
    946           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    947          void SAPI_Init( byte task_id )
   \                     SAPI_Init:
    948          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    949            sapi_TaskID = task_id;
   \   00000C   90....       MOV     DPTR,#sapi_TaskID
   \   00000F   F0           MOVX    @DPTR,A
    950            sapi_bindInProgress = 0xffff;
   \   000010   90....       MOV     DPTR,#sapi_bindInProgress
   \   000013   74FF         MOV     A,#-0x1
   \   000015   F0           MOVX    @DPTR,A
   \   000016   A3           INC     DPTR
   \   000017   F0           MOVX    @DPTR,A
    951          
    952            sapi_epDesc.task_id = &sapi_TaskID;
   \   000018   90....       MOV     DPTR,#(sapi_epDesc + 1)
   \   00001B   74..         MOV     A,#(sapi_TaskID & 0xff)
   \   00001D   F0           MOVX    @DPTR,A
   \   00001E   A3           INC     DPTR
   \   00001F   74..         MOV     A,#((sapi_TaskID >> 8) & 0xff)
   \   000021   F0           MOVX    @DPTR,A
    953            sapi_epDesc.endPoint = 0;
   \   000022   E4           CLR     A
   \   000023   90....       MOV     DPTR,#sapi_epDesc
   \   000026   F0           MOVX    @DPTR,A
    954            
    955          #if ( SAPI_CB_FUNC )
    956            sapi_epDesc.endPoint = zb_SimpleDesc.EndPoint;
   \   000027   90....       MOV     DPTR,#zb_SimpleDesc
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   90....       MOV     DPTR,#sapi_epDesc
   \   00002E   F0           MOVX    @DPTR,A
    957            sapi_epDesc.task_id = &sapi_TaskID;
    958            sapi_epDesc.simpleDesc = (SimpleDescriptionFormat_t *)&zb_SimpleDesc;
   \   00002F   90....       MOV     DPTR,#(sapi_epDesc + 3)
   \   000032   74..         MOV     A,#(zb_SimpleDesc & 0xff)
   \   000034   F0           MOVX    @DPTR,A
   \   000035   A3           INC     DPTR
   \   000036   74..         MOV     A,#((zb_SimpleDesc >> 8) & 0xff)
   \   000038   F0           MOVX    @DPTR,A
    959            sapi_epDesc.latencyReq = noLatencyReqs;
   \   000039   E4           CLR     A
   \   00003A   90....       MOV     DPTR,#(sapi_epDesc + 5)
   \   00003D   F0           MOVX    @DPTR,A
    960          
    961            // Register the endpoint/interface description with the AF
    962            afRegister( &sapi_epDesc );
   \   00003E                ; Setup parameters for call to function afRegister
   \   00003E   7A..         MOV     R2,#(sapi_epDesc & 0xff)
   \   000040   7B..         MOV     R3,#((sapi_epDesc >> 8) & 0xff)
   \   000042   12....       LCALL   ??afRegister?relay
    963          #endif
    964          
    965            // Turn off match descriptor response by default
    966            afSetMatch(sapi_epDesc.simpleDesc->EndPoint, FALSE);
   \   000045                ; Setup parameters for call to function afSetMatch
   \   000045   12....       LCALL   ?Subroutine4 & 0xFFFF
    967          
    968            // Register callback evetns from the ZDApp
    969            ZDO_RegisterForZDOMsg( sapi_TaskID, NWK_addr_rsp );
   \                     ??CrossCallReturnLabel_9:
   \   000048                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000048   7A00         MOV     R2,#0x0
   \   00004A   7B80         MOV     R3,#-0x80
   \   00004C   90....       MOV     DPTR,#sapi_TaskID
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   F9           MOV     R1,A
   \   000051   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    970            ZDO_RegisterForZDOMsg( sapi_TaskID, Match_Desc_rsp );
   \   000054                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000054   7A06         MOV     R2,#0x6
   \   000056   7B80         MOV     R3,#-0x80
   \   000058   90....       MOV     DPTR,#sapi_TaskID
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   F9           MOV     R1,A
   \   00005D   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    971          
    972          #if ( SAPI_CB_FUNC )
    973          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    974            // Register for HAL events
    975            RegisterForKeys( sapi_TaskID );
   \   000060                ; Setup parameters for call to function RegisterForKeys
   \   000060   90....       MOV     DPTR,#sapi_TaskID
   \   000063   E0           MOVX    A,@DPTR
   \   000064   F9           MOV     R1,A
   \   000065   12....       LCALL   ??RegisterForKeys?relay
    976          
    977            if ( HalKeyRead () == HAL_KEY_SW_5)
   \   000068                ; Setup parameters for call to function HalKeyRead
   \   000068   12....       LCALL   ??HalKeyRead?relay
   \   00006B   E9           MOV     A,R1
   \   00006C   6404         XRL     A,#0x4
   \   00006E   7016         JNZ     ??SAPI_Init_0
    978            {
    979              // If SW5 is pressed and held while powerup, force auto-start and nv-restore off and reset
    980              uint8 startOptions = ZCD_STARTOPT_CLEAR_STATE | ZCD_STARTOPT_CLEAR_CONFIG;
   \   000070   7403         MOV     A,#0x3
   \   000072   85..82       MOV     DPL,?XSP + 0
   \   000075   85..83       MOV     DPH,?XSP + 1
   \   000078   F0           MOVX    @DPTR,A
    981              zb_WriteConfiguration( ZCD_NV_STARTUP_OPTION, sizeof(uint8), &startOptions );
   \   000079                ; Setup parameters for call to function zb_WriteConfiguration
   \   000079   AC82         MOV     R4,DPL
   \   00007B   AD83         MOV     R5,DPH
   \   00007D   7A01         MOV     R2,#0x1
   \   00007F   F9           MOV     R1,A
   \   000080   12....       LCALL   ??zb_WriteConfiguration?relay
    982              zb_SystemReset();
   \   000083                ; Setup parameters for call to function zb_SystemReset
   \   000083   12....       LCALL   ??zb_SystemReset?relay
    983            }
    984          #endif // HAL_KEY
    985          
    986            // Set an event to start the application
    987            osal_set_event(task_id, ZB_ENTRY_EVENT);
   \                     ??SAPI_Init_0:
   \   000086                ; Setup parameters for call to function osal_set_event
   \   000086   7A00         MOV     R2,#0x0
   \   000088   7B10         MOV     R3,#0x10
   \   00008A   EE           MOV     A,R6
   \   00008B   F9           MOV     R1,A
   \   00008C   12....       LCALL   ??osal_set_event?relay
    988          #endif
    989          #if (DEVICE_LOGICAL_TYPE == ZG_DEVICETYPE_ENDDEVICE)
    990               osal_set_event( sapi_TaskID, MY_REPORT_EVT );
   \   00008F                ; Setup parameters for call to function osal_set_event
   \   00008F   7A02         MOV     R2,#0x2
   \   000091   7B00         MOV     R3,#0x0
   \   000093   90....       MOV     DPTR,#sapi_TaskID
   \   000096   E0           MOVX    A,@DPTR
   \   000097   F9           MOV     R1,A
   \   000098   12....       LCALL   ??osal_set_event?relay
    991               reportState = TRUE;
   \   00009B   7401         MOV     A,#0x1
   \   00009D   90....       MOV     DPTR,#reportState
   \   0000A0   F0           MOVX    @DPTR,A
    992          
    993          #endif
    994            
    995            
    996            
    997            
    998          }
   \   0000A1   02....       LJMP    ?Subroutine13 & 0xFFFF
    999          /*********************************************************************
   1000           * @fn      SAPI_SendCback
   1001           *
   1002           * @brief   Sends a message to the sapi task ( itself ) so that a
   1003           *           callback can be generated later.
   1004           *
   1005           * @return  none
   1006           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1007          void SAPI_SendCback( uint8 event, uint8 status, uint16 data )
   \                     SAPI_SendCback:
   1008          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
   \   000007   8A..         MOV     ?V0 + 1,R2
   \   000009   EC           MOV     A,R4
   \   00000A   FE           MOV     R6,A
   \   00000B   ED           MOV     A,R5
   \   00000C   FF           MOV     R7,A
   1009            sapi_CbackEvent_t *pMsg;
   1010          
   1011            pMsg = (sapi_CbackEvent_t *)osal_msg_allocate( sizeof(sapi_CbackEvent_t) );
   \   00000D                ; Setup parameters for call to function osal_msg_allocate
   \   00000D   7A04         MOV     R2,#0x4
   \   00000F   7B00         MOV     R3,#0x0
   \   000011   12....       LCALL   ??osal_msg_allocate?relay
   1012            if( pMsg )
   \   000014   EA           MOV     A,R2
   \   000015   7001         JNZ     ??SAPI_SendCback_0
   \   000017   EB           MOV     A,R3
   \                     ??SAPI_SendCback_0:
   \   000018   601B         JZ      ??SAPI_SendCback_1
   1013            {
   1014              pMsg->hdr.event = event;
   \   00001A   8A82         MOV     DPL,R2
   \   00001C   8B83         MOV     DPH,R3
   \   00001E   E5..         MOV     A,?V0 + 0
   \   000020   F0           MOVX    @DPTR,A
   1015              pMsg->hdr.status = status;
   \   000021   A3           INC     DPTR
   \   000022   E5..         MOV     A,?V0 + 1
   \   000024   12....       LCALL   ?Subroutine9 & 0xFFFF
   1016              pMsg->data = data;
   \                     ??CrossCallReturnLabel_16:
   \   000027   A3           INC     DPTR
   \   000028   EE           MOV     A,R6
   \   000029   F0           MOVX    @DPTR,A
   \   00002A   A3           INC     DPTR
   \   00002B   EF           MOV     A,R7
   \   00002C   F0           MOVX    @DPTR,A
   1017          
   1018              osal_msg_send( sapi_TaskID, (uint8 *)pMsg );
   \   00002D                ; Setup parameters for call to function osal_msg_send
   \   00002D   90....       MOV     DPTR,#sapi_TaskID
   \   000030   E0           MOVX    A,@DPTR
   \   000031   F9           MOV     R1,A
   \   000032   12....       LCALL   ??osal_msg_send?relay
   1019            }
   1020          
   1021          }
   \                     ??SAPI_SendCback_1:
   \   000035   7F04         MOV     R7,#0x4
   \   000037   02....       LJMP    ?BANKED_LEAVE_XDATA
   1022          
   1023          #if OSAL_SAPI
   1024          /*********************************************************************
   1025           * @fn      osalInitTasks
   1026           *
   1027           * @brief   This function invokes the initialization function for each task.
   1028           *
   1029           * @param   void
   1030           *
   1031           * @return  none
   1032           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1033          void osalInitTasks( void )
   \                     osalInitTasks:
   1034          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1035            uint8 taskID = 0;
   1036          
   1037            tasksEvents = (uint16 *)osal_mem_alloc( sizeof( uint16 ) * tasksCnt);
   \   000004                ; Setup parameters for call to function osal_mem_alloc
   \   000004   7A0C         MOV     R2,#0xc
   \   000006   7B00         MOV     R3,#0x0
   \   000008   12....       LCALL   ??osal_mem_alloc?relay
   \   00000B   90....       MOV     DPTR,#tasksEvents
   \   00000E   EA           MOV     A,R2
   \   00000F   F0           MOVX    @DPTR,A
   \   000010   A3           INC     DPTR
   \   000011   EB           MOV     A,R3
   \   000012   F0           MOVX    @DPTR,A
   1038            osal_memset( tasksEvents, 0, (sizeof( uint16 ) * tasksCnt));
   \   000013                ; Setup parameters for call to function osal_memset
   \   000013   7C0C         MOV     R4,#0xc
   \   000015   7D00         MOV     R5,#0x0
   \   000017   7900         MOV     R1,#0x0
   \   000019   12....       LCALL   ??osal_memset?relay
   1039          
   1040            macTaskInit( taskID++ );
   \   00001C                ; Setup parameters for call to function macTaskInit
   \   00001C   7900         MOV     R1,#0x0
   \   00001E   12....       LCALL   ??macTaskInit?relay
   1041            nwk_init( taskID++ );
   \   000021                ; Setup parameters for call to function nwk_init
   \   000021   7901         MOV     R1,#0x1
   \   000023   12....       LCALL   ??nwk_init?relay
   1042            Hal_Init( taskID++ );
   \   000026                ; Setup parameters for call to function Hal_Init
   \   000026   7902         MOV     R1,#0x2
   \   000028   12....       LCALL   ??Hal_Init?relay
   1043          #if defined( MT_TASK )
   1044            MT_TaskInit( taskID++ );
   1045          #endif
   1046            APS_Init( taskID++ );
   \   00002B                ; Setup parameters for call to function APS_Init
   \   00002B   7903         MOV     R1,#0x3
   \   00002D   12....       LCALL   ??APS_Init?relay
   1047            ZDApp_Init( taskID++ );
   \   000030                ; Setup parameters for call to function ZDApp_Init
   \   000030   7904         MOV     R1,#0x4
   \   000032   12....       LCALL   ??ZDApp_Init?relay
   1048            SAPI_Init( taskID );
   \   000035                ; Setup parameters for call to function SAPI_Init
   \   000035   7905         MOV     R1,#0x5
   \   000037   12....       LCALL   ??SAPI_Init?relay
   1049          }
   \   00003A   02....       LJMP    ?Subroutine15 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   8C82         MOV     DPL,R4
   \   000002   8D83         MOV     DPH,R5
   \   000004                REQUIRE ??Subroutine20_0
   \   000004                ; // Fall through to label ??Subroutine20_0

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_SystemReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_SystemReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_StartRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_StartRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_BindDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_BindDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_PermitJoiningRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_PermitJoiningRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_AllowBind?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_AllowBind

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_SendDataRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_SendDataRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_ReadConfiguration?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_ReadConfiguration

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_WriteConfiguration?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_WriteConfiguration

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_GetDeviceInfo?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_GetDeviceInfo

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zb_FindDeviceRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zb_FindDeviceRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SAPI_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SAPI_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SAPI_ProcessZDOMsgs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SAPI_ProcessZDOMsgs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SAPI_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SAPI_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SAPI_SendCback?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SAPI_SendCback

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??osalInitTasks?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    osalInitTasks
   1050          #endif
   1051          
   1052          /*********************************************************************
   1053          *********************************************************************/
   1054          

   Maximum stack usage in bytes:

     Function                      ISTACK PSTACK XSTACK
     --------                      ------ ------ ------
     SAPI_Init                         1      0     10
       -> afRegister                   0      0     20
       -> afSetMatch                   0      0     20
       -> ZDO_RegisterForZDOMsg        0      0     20
       -> ZDO_RegisterForZDOMsg        0      0     20
       -> RegisterForKeys              0      0     20
       -> HalKeyRead                   0      0     20
       -> zb_WriteConfiguration        0      0     20
       -> zb_SystemReset               0      0     20
       -> osal_set_event               0      0     20
       -> osal_set_event               0      0     20
     SAPI_ProcessEvent                 0      0     19
       -> osal_msg_receive             0      0     30
       -> zb_StartConfirm              0      0     30
       -> osal_msg_deallocate          0      0     30
       -> osal_msg_receive             0      0     30
       -> SAPI_ProcessZDOMsgs          0      0     30
       -> zb_SendDataConfirm           0      0     30
       -> zb_ReceiveDataIndication     0      0     38
       -> zb_StartConfirm              0      0     30
       -> zb_StartConfirm              0      0     30
       -> zb_AllowBindConfirm          0      0     30
       -> zb_HandleKeys                0      0     30
       -> zb_SendDataConfirm           0      0     30
       -> zb_BindConfirm               0      0     30
       -> afSetMatch                   0      0     30
       -> zb_BindConfirm               0      0     30
       -> zb_HandleOsalEvent           0      0     30
       -> HalLedSet                    0      0     30
       -> zb_ReadConfiguration         0      0     30
       -> zb_StartRequest              0      0     30
       -> HalLedBlink                  0      0     30
       -> zb_HandleOsalEvent           0      0     30
     SAPI_ProcessZDOMsgs               1      0     35
       -> ZDO_ParseAddrRsp             0      0     38
       -> zb_FindDeviceConfirm         0      0     38
       -> ZDO_ParseEPListRsp           0      0     38
       -> APSME_BindRequest            0      0     40
       -> osal_stop_timerEx            0      0     38
       -> osal_start_timerEx           0      0     38
       -> ZDP_IEEEAddrReq              0      0     38
       -> zb_BindConfirm               0      0     38
     SAPI_SendCback                    1      0     38
       -> osal_msg_allocate            0      0     24
       -> osal_msg_send                0      0     24
     osalInitTasks                     2      0      0
       -> osal_mem_alloc               4      0      0
       -> osal_memset                  4      0      0
       -> macTaskInit                  4      0      0
       -> nwk_init                     4      0      0
       -> Hal_Init                     4      0      0
       -> APS_Init                     4      0      0
       -> ZDApp_Init                   4      0      0
       -> SAPI_Init                    4      0      0
     zb_AllowBind                      0      0      9
       -> osal_stop_timerEx            0      0     18
       -> afSetMatch                   0      0     18
       -> afSetMatch                   0      0     18
       -> osal_start_timerEx           0      0     18
     zb_BindDevice                     1      0     29
       -> sAddrExtCpy                  0      0     42
       -> APSME_BindRequest            0      0     44
       -> ZDP_NwkAddrReq               0      0     42
       -> osal_start_timerEx           0      0     42
       -> SAPI_SendCback               0      0     42
       -> ZDO_AnyClusterMatches        0      0     46
       -> ZDP_MatchDescReq             0      0     58
       -> ZDO_AnyClusterMatches        0      0     46
       -> ZDP_MatchDescReq             0      0     58
       -> osal_start_timerEx           0      0     42
       -> bindRemoveEntry              0      0     42
       -> bindFind                     0      0     42
       -> osal_start_timerEx           0      0     42
     zb_FindDeviceRequest              2      0      0
       -> ZDP_NwkAddrReq               4      0      0
     zb_GetDeviceInfo                  0      0     14
       -> osal_memcpy                  0      0     28
       -> osal_memcpy                  0      0     28
       -> osal_memcpy                  0      0     28
       -> osal_memcpy                  0      0     28
       -> osal_memcpy                  0      0     28
       -> osal_memcpy                  0      0     28
       -> osal_memcpy                  0      0     28
       -> osal_memcpy                  0      0     28
     zb_PermitJoiningRequest           0      0      0
     zb_ReadConfiguration              0      0     30
       -> osal_nv_item_len             0      0     22
       -> osal_nv_read                 0      0     30
     zb_SendDataRequest                1      0     40
       -> NLME_IsAddressBroadcast      0      0     52
       -> AF_DataRequest               0      0     70
       -> SAPI_SendCback               0      0     52
     zb_StartRequest                   1      0     25
       -> zb_ReadConfiguration         0      0     20
       -> SAPI_SendCback               0      0     20
       -> ZDOInitDevice                0      0     20
     zb_SystemReset                    0      0     10
     zb_WriteConfiguration             0      0     24
       -> osal_nv_write                0      0     28


   Segment part sizes:

     Function/Label                  Bytes
     --------------                  -----
     _A_IEN0                            1
     WDCTL                              1
     tasksArr                          12
     tasksCnt                           1
     tasksEvents                        2
     sapi_epDesc                        6
     sapi_TaskID                        1
     sapi_bindInProgress                2
     zb_SystemReset                    10
     zb_StartRequest                   69
     ?Subroutine13                      3
     ??Subroutine18_0                   5
     ?Subroutine0                      11
     zb_BindDevice                    461
     ?Subroutine14                      8
     ?Subroutine7                       5
     ?Subroutine3                      20
     ?Subroutine5                      11
     ??Subroutine19_0                   6
     ?Subroutine11                      4
     ?Subroutine12                     12
     ??Subroutine20_0                   6
     ?Subroutine1                       9
     ?Subroutine10                      6
     zb_PermitJoiningRequest            5
     zb_AllowBind                      79
     ?Subroutine8                       5
     zb_SendDataRequest               201
     ?Subroutine16                      8
     zb_ReadConfiguration              63
     ?Subroutine17                      5
     zb_WriteConfiguration             40
     zb_GetDeviceInfo                 134
     zb_FindDeviceRequest              18
     ?Subroutine15                      7
     SAPI_ProcessEvent                467
     ?Subroutine2                      20
     ?Subroutine4                       9
     SAPI_ProcessZDOMsgs              202
     ?Subroutine9                       7
     SAPI_Init                        164
     SAPI_SendCback                    58
     osalInitTasks                     61
     ?Subroutine6                       4
     ??zb_SystemReset?relay             6
     ??zb_StartRequest?relay            6
     ??zb_BindDevice?relay              6
     ??zb_PermitJoiningRequest?relay    6
     ??zb_AllowBind?relay               6
     ??zb_SendDataRequest?relay         6
     ??zb_ReadConfiguration?relay       6
     ??zb_WriteConfiguration?relay      6
     ??zb_GetDeviceInfo?relay           6
     ??zb_FindDeviceRequest?relay       6
     ??SAPI_ProcessEvent?relay          6
     ??SAPI_ProcessZDOMsgs?relay        6
     ??SAPI_Init?relay                  6
     ??SAPI_SendCback?relay             6
     ??osalInitTasks?relay              6

 
 2 203 bytes in segment BANKED_CODE
    90 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
    13 bytes in segment XDATA_ROM_C
    11 bytes in segment XDATA_Z
 
 2 293 bytes of CODE  memory
    13 bytes of CONST memory
     0 bytes of DATA  memory (+ 2 bytes shared)
    11 bytes of XDATA memory

Errors: none
Warnings: none
